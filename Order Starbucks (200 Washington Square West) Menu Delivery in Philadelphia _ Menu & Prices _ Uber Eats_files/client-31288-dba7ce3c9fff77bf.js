"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[31288],{2733:(t,e,i)=>{i.d(e,{A:()=>n});var a=i(40304),o=i(52916);const n=()=>{const t={...o.I.saved_customizations,defaultValue:!1};return{isSavedCustomizationsXpEnabled:(0,a.vm)(t)}}},6531:(t,e,i)=>{i.d(e,{A:()=>r});var a=i(90417),o=i(41908),n=i(8700);const r=t=>{const{serverCart:e}=(0,o.B_)(),{store:i}=(0,n.Ay)(t??e.data?.storeUuid);return(0,a.useMemo)((()=>i.data?.catalogSectionsMap?(t=>{const e=Object.values(t.data?.catalogSectionsMap||{}).reduce(((t,e)=>[...t,...e]),[]).map((t=>t.payload?t.payload[t.payload.type]?.catalogItems:[])).filter(Boolean).reduce(((t,e)=>[...t,...e]),[]);return Object.fromEntries(e.map((t=>[t.uuid,t])))})(i):(t=>Object.values(t.data?.sectionEntitiesMap||{}).reduce(((t,e)=>({...t,...e})),{}))(i)),[i])}},14337:(t,e,i)=>{i.d(e,{n_:()=>k,Ay:()=>K,EE:()=>G,Qn:()=>q});var a=i(90417),o=i(77142),n=i(2499),r=i(67152),u=i(12615),s=i(66197),m=i(4914),l=i(17649),d=i(31233),c=i(47577),E=i(80672),p=i(87731),_=i(77692);const I=(t,e)=>{const i=(0,m.c)(),a=(0,p.A)(),{currentUserCartItems:o,draftOrderUuid:n,isDraftOrderParticipant:r}=(0,l.A)(t),{groupOrder:u,getGroupOrder:I,shouldGetGroupOrder:y}=(0,d.A)(n),{hasGroupOrderForStore:f}=(0,s.A)(t||"");(0,c.A)((()=>y&&f?I():null),[y,I,f],"use-draft-order-spending-limit-validation");const C=(0,E.WZ)({cartItems:o})+e,D=u.data?.spendingLimitAmount,L=D?.currencyCode;if(!D||!L)return null;const A=D.amount;return f&&r&&C>A?i("go.spending_limit_exceeded",{spendingLimit:(0,_.vv)(a,L,A)}):null};var y=i(41908),f=i(47916),C=i(35508),D=i(7139),L=i(56831),A=i(41413),O=i(52288),R=i(2733),P=i(86105),M=i(24518),S=i(5654),U=i(15478);const b=t=>{let{itemUuid:e,defaultQuantity:i,quantityIncrement:o,updateDecimalQuantity:n,isEditItem:r,didSetDefaultQuantity:u,setDidSetDefaultQuantity:s}=t;const m=(0,P.zy)(),l=(0,a.useRef)(!1),{previousContext:d}=m.state||{},c=d===M.OH.PDP_CROSS_SELL,E=(0,S.A)(c),{isBOGAFreeItemSection:p}=(0,U.N)(),_=(0,S.A)(p),I=(0,a.useCallback)((t=>{l.current=!0,n(C.R9.from(t).updateExponent(o.exponent).toBaseDecimal())}),[o.exponent,n]);(0,a.useEffect)((()=>()=>{e&&u&&s(!1)}),[u,e,s]),(0,a.useEffect)((()=>{if(!r&&!l.current&&e&&(c||E)&&!(p||_))return(0===o.exponent||i)&&I(i||1),()=>{l.current=!1}}),[i,c,r,E,e,o.exponent,I,p,_])};var N=i(40988),g=i(40304),h=i(52916),T=i(86943),z=i(31725);const x=Object.freeze({UNKNOWN:"UNKNOWN",FLAT:"FLAT",PERCENT:"PERCENT",FREE_DELIVERY:"FREE_DELIVERY",DISCOUNT_DELIVERY:"DISCOUNT_DELIVERY",BOGO:"BOGO",FREE_ITEM:"FREE_ITEM",DISCOUNTED_ITEM:"DISCOUNTED_ITEM",VIRTUALPROMO_UBERCASH:"VIRTUALPROMO_UBERCASH",CATEGORY_DISCOUNT:"CATEGORY_DISCOUNT",VOLUME_DISCOUNT:"VOLUME_DISCOUNT",BXGY:"BXGY",FREE_DELIVERY_AND_SERVICE_FEES:"FREE_DELIVERY_AND_SERVICE_FEES",NO_FEES:"NO_FEES",BOGA:"BOGA",MULTI_SKU_FLAT:"MULTI_SKU_FLAT",FREE_PREMIUM_DELIVERY:"FREE_PREMIUM_DELIVERY",UGC_INCENTIVE:"UGC_INCENTIVE",SERVICE_FEES:"SERVICE_FEES",PLACEHOLDER_19:"PLACEHOLDER_19",PLACEHOLDER_20:"PLACEHOLDER_20",PLACEHOLDER_21:"PLACEHOLDER_21",PLACEHOLDER_22:"PLACEHOLDER_22",PLACEHOLDER_23:"PLACEHOLDER_23",PLACEHOLDER_24:"PLACEHOLDER_24",PLACEHOLDER_25:"PLACEHOLDER_25",PLACEHOLDER_26:"PLACEHOLDER_26",PLACEHOLDER_27:"PLACEHOLDER_27",PLACEHOLDER_28:"PLACEHOLDER_28",PLACEHOLDER_29:"PLACEHOLDER_29",PLACEHOLDER_30:"PLACEHOLDER_30",PLACEHOLDER_31:"PLACEHOLDER_31",PLACEHOLDER_32:"PLACEHOLDER_32"});var F=i(97684),B=i(95884),V=i(28123),Q=i(73792);const v=(t,e,i,a)=>{const o=t?.data;return o?(0,n.hS)(o.customizationsList,(0,F.X)(H(t,e,i,a??!1))):""},H=(t,e,i,a)=>{const o=t?.data;if(!o)return{};const r=(0,n.uj)({selectedCustomizations:e,customizationsList:t?.data?.customizationsList||[],addQuantityInfo:i,addCustomizationMeta:a??!1})||{};return(0,n.VZ)(o.customizationsList,r)},G=t=>{let{menuItem:e,customizations:i,quantity:a,itemUpsellState:r,currentFreeItems:u,addQuantityInfo:s,isItemTotalDiscountMigrationEnabled:m,enableBogoPriceCalculationFix:l,addCustomizationMeta:d}=t;const c=e?.data?.price||0,E=(0,n.uj)({selectedCustomizations:i,customizationsList:e?.data?.customizationsList||[],addQuantityInfo:s,addCustomizationMeta:d})||{},{itemPromotionV2:p}=e?.data||{},{promotionData:_}=p||{},I=a;let y=0;if(!_?.type)return null;const f=(0,T.o)(e?.data?.itemPromotionV2?.promotionData),{itemCustomizationSum:C}=(0,o.R0)({customizations:i,upsellItems:r.itemsArray,upsellItemsMap:r.itemMap});switch(_.type){case L.Ei.buyXGetYItemPromotion:{const{buyQuantity:t,getQuantity:e,maxRedemptionCount:i}=_,a=t+e;if(t>0&&e>0&&I>=a){const t=null!=u?u:Math.floor(I/a);y=I-e*Math.min(i,t)}return(0,o.Jb)({quantityPromoted:y,itemPrice:c,customizations:E,upsellItems:r.itemsArray,upsellItemsMap:r.itemMap,totalQuantity:f&&C<0&&m?y:I,enableBogoPriceCalculationFix:l})}case L.Ei.volumeDiscountPromotion:{const{buyQuantity:t,discountAmount:e,maxRedemptionCount:i}=_;if(t>0&&I>=t){const e=Math.floor(I/t);y=Math.min(i,e)}return(0,o.Jb)({quantityPromoted:y,itemPrice:c,customizations:E,upsellItems:r.itemsArray,upsellItemsMap:r.itemMap,discountAmount:e,totalQuantity:I,enableBogoPriceCalculationFix:l})}default:return null}},q=t=>{let{menuItem:e,customizations:i,quantity:a,itemUpsellState:r,addQuantityInfo:u,isItemTotalDiscountMigrationEnabled:s=!1,isChargeThresholdV2Enabled:m=!1,addCustomizationMeta:l=!1}=t;const{itemCustomizationSum:d}=(0,o.R0)({customizations:i,upsellItems:r.itemsArray,upsellItemsMap:r.itemMap,isChargeThresholdV2Enabled:m}),c=e?.data?.price||0,E=s?function(t){let{price:e,priceBeforeDiscount:i,itemCustomizationSum:a,offerInfo:o}=t;if(a<0){const t=o?.discountPercentage||0;return Math.max(i-(i+a)*t,0)}return e}({price:c,priceBeforeDiscount:e?.data?.priceBeforeDiscount||0,itemCustomizationSum:d,offerInfo:e?.data?.itemPromotionV2?.offerInfo}):c,p=(0,n.uj)({selectedCustomizations:i,customizationsList:e?.data?.customizationsList||[],addQuantityInfo:u,addCustomizationMeta:l})||{};return(0,o.mE)({itemQuantity:a,itemPrice:E,customizations:p,upsellItems:r.itemsArray,upsellItemsMap:r.itemMap,isChargeThresholdV2Enabled:m})};let k=function(t){return t.increment="INCREMENT",t.decrement="DECREMENT",t.set="SET",t}({});const K=t=>{let{store:e,menuItem:i,selectedSavedCustomizationIndex:o,setSelectedSavedCustomizationIndex:m,initialQuantity:l,initialDecimalQuantity:d,initialCustomizations:c,initialSpecialInstructions:E,isEditQuantityFlow:p}=t;const[_,P]=(0,a.useState)(E||""),[M,S]=(0,a.useState)(c||{}),U=i.data?(0,D.ES)(i.data):null,T=U?.defaultDecimal||U?.minPermitted,K=C.R9.from(U?.increment??1).toBaseDecimal(),w=C.R9.from(U?.minPermitted??1).updateExponent(K?.exponent||0).toBaseDecimal(),Y=(0,f.A)({item:i.data,storeUuid:e.data?.uuid,counterAdjustment:l}),X=(t=>{let{initialQuantity:e,initialDecimalQuantity:i,quantityIncrement:a,defaultQuantity:o}=t;return i?i.toBaseDecimal():e?C.R9.from(e).updateExponent(a.exponent).toBaseDecimal():o||C.R9.from(1).updateExponent(a.exponent).toBaseDecimal()})({initialQuantity:l,initialDecimalQuantity:d,defaultQuantity:T,quantityIncrement:K}),j=e?.data?.uuid||"",{isDraftOrderParticipantForStore:W,canEditGroupOrderCart:Z}=(0,s.A)(j),{serverCart:J}=(0,y.B_)(),[$,tt]=(0,a.useState)(X),[et,it]=(0,a.useState)(!1),[at,ot]=(0,a.useState)(!1),{isItemInPromotion:nt,initialItemQuantity:rt}=(t=>{const{itemPromotionV2:e}=t||{},i={isItemInPromotion:!1,initialItemQuantity:1};if(!t)return i;const{promotionData:a}=e||{};if(!a?.type)return i;if(a.type===L.Ei.buyXGetYItemPromotion){const{buyQuantity:t,getQuantity:e}=a;return{isItemInPromotion:!0,initialItemQuantity:1===t&&1===e?2:1}}return i})(i.data),{isSavedCustomizationsXpEnabled:ut}=(0,R.A)(),st=(0,z.A)("item_total_discount_migration_enabled"),mt=(0,a.useMemo)((()=>i?.data?.customizationsList||[]),[i?.data?.customizationsList]),lt=C.R9.from($||1).toFloat(),{currentFreeItems:dt}=(0,N.r)({storeUuid:j,item:i.data,quantity:lt,selectedCustomizations:M,isUpdateFlow:p});(0,a.useEffect)((()=>{"number"!=typeof K?.exponent||$.exponent===K.exponent||$===T||d||tt(C.R9.from(lt).updateExponent(K.exponent).toBaseDecimal())}),[$,T,lt,$.exponent,K.exponent,d]),(0,a.useEffect)((()=>{p||"number"!=typeof T?.exponent||$.exponent===T.exponent||at||(ot(!0),tt(C.R9.from(T).toBaseDecimal()))}),[at,T,$.exponent,p]),(0,a.useEffect)((()=>{!nt||et||l||(it(!0),tt({base:rt,exponent:0}))}),[i,et,l,rt,nt]),(0,a.useEffect)((()=>{const t=(0,O.M1)(i.data?.productDetailsItems);if(ut&&-1===o)return S({}),void P("");const e=ut&&null!=o&&o>=0?t?.preselectedCustomizationSelection?.[o]?.item:void 0,{customizations:a,specialInstructions:r}=(t=>{let{itemUuid:e,menuItemCustomizationList:i,initialCustomizations:a,orderItem:o}=t;if(!e||!i)return null;if(a)return{customizations:(0,n.xn)(a||{},i,!1)};if(o){const t=o?.customizationV2s||[],e=o?.specialInstructions,a=(0,n.at)((0,A.ZY)(t));return{customizations:(0,n.xn)(a,i,!0),...e?{specialInstructions:e}:null}}return null})({itemUuid:i.data?.uuid,menuItemCustomizationList:mt,initialCustomizations:c,orderItem:e})||{};a&&S(a),r&&P(r)}),[mt,c,i.data?.uuid,i.data?.productDetailsItems,o,ut]),(0,a.useEffect)((()=>{p&&(at||!l&&!d||(ot(!0),tt(X)))}),[X,at,d,l,p]),b({itemUuid:i.data?.uuid,defaultQuantity:T,quantityIncrement:K,updateDecimalQuantity:tt,isEditItem:Boolean(p||l),didSetDefaultQuantity:at,setDidSetDefaultQuantity:ot});const[ct,Et]=(0,a.useReducer)(r.y,r.u);const pt=(0,a.useCallback)((t=>P(t)),[]),_t=i?.data?.sectionUuid||"",It=(e?.data?.sections||[]).find((t=>t.uuid===_t)),yt=null==It||!1!==It.isOnSale,ft=Boolean(e?.data?.isOpen),Ct=(0,u.A)(),Dt=Boolean(e?.data?.isWithinDeliveryRange),Lt=(i?.data?.suspendUntil||0)>0,At=Boolean(e?.data?.isPreview),Ot="geolocation_api"!==Ct?.originType,Rt=!!e?.data&&(0,V.iC)(e.data),Pt=(0,B.c)({skip:Boolean(Rt)}),Mt="PICKUP"===(0,Q.W)(),St=Pt&&Mt,Ut=At||yt&&!Lt&&(W||ft&&Boolean(Ct)&&Ot&&Dt||St),bt=(0,g.vm)({...h.I.edit_flow_quantity_info_fix,defaultValue:!1}),Nt=(0,g.vm)({...h.I.bogo_price_calculation_fix,defaultValue:!1}),gt=i?.data?.itemPromotionV2?.availablePromotion?.promoDataTypeV2===x.DISCOUNTED_ITEM,ht=(0,z.A)("product_details_charge_threshold_v2_enabled"),Tt=ht,zt=q({menuItem:i,customizations:M,quantity:lt,itemUpsellState:ct,addQuantityInfo:bt,isItemTotalDiscountMigrationEnabled:st&&gt,isChargeThresholdV2Enabled:ht,addCustomizationMeta:Tt}),xt=Boolean(l),Ft=G({menuItem:i,customizations:M,quantity:lt,itemUpsellState:ct,currentFreeItems:dt,addQuantityInfo:bt,isItemTotalDiscountMigrationEnabled:st,enableBogoPriceCalculationFix:Nt,addCustomizationMeta:Tt})??0,Bt=xt&&l?q({menuItem:i,customizations:M,quantity:l,itemUpsellState:ct,addQuantityInfo:bt,addCustomizationMeta:Tt}):0,Vt=Ft>0?Ft:zt,Qt=I(j,xt?Vt-Bt:Vt),vt=(t=>"eats.exceed_spending_limit.error"===t?.error?.meta?.code&&t?.error?.message?t?.error?.message:null)(J),Ht=Qt||vt;return{quantity:lt,updateQuantity:function(t,e){const i=t===k.set&&null!=e?C.R9.from(e):C.R9.from(K).multiply(t===k.increment?1:-1).add($);C.R9.from(i).isGte(w)&&(t===k.decrement||Y({increment:C.R9.from(i).toFloat(),showSnackbarWarning:!0})!==f.o.ABOVE_LIMIT)&&tt(i.toBaseDecimal())},decimalQuantity:$,specialInstructions:_,updateSpecialInstructions:pt,updateCustomizations:t=>{ut&&m&&m(null),S(t)},selectedCustomizations:M,itemsUpsell:ct,updateUpsellItemQuantity:(t,e)=>{Et(e>0?{type:"ADD_ITEM_UPSELL",payload:{item:t}}:{type:"SUB_ITEM_UPSELL",payload:{item:t}})},hasErrors:(0,F.X)(H(i,M,bt,Tt)).length>0,isOnSale:Ut,totalPrice:zt,spendingLimitError:Ht,canEditGroupOrderCart:Z,firstIncompleteGroup:v(i,M,bt,Tt),discountedPrice:Ft}}},15478:(t,e,i)=>{i.d(e,{N:()=>r});var a=i(40304),o=i(1139),n=i(86105);function r(){const t=(0,n.zy)(),e=(0,a.Ab)({...o.z.boga_catalog_section_uuid,defaultValue:""});return{isBOGAFreeItemSection:t?.state?.inMemoryCartContext?.referrerItemCatalog===e}}},40988:(t,e,i)=>{i.d(e,{K:()=>y,r:()=>I});var a=i(90417),o=i(4914),n=i(31725),r=i(61925),u=i(87731),s=i(77692),m=i(86943),l=i(14337),d=i(67152);const c=Object.freeze({UNKNOWN:"UNKNOWN",STRIKE_THROUGH:"STRIKE_THROUGH",UNDERLINE:"UNDERLINE"});Object.freeze({UNKNOWN:"UNKNOWN",HEAD:"HEAD",MIDDLE:"MIDDLE",TAIL:"TAIL"});var E=i(40304),p=i(52916),_=i(19017);const I=t=>{let{storeUuid:e,item:i,quantity:o,selectedCustomizations:n,isUpdateFlow:u}=t;const s=i?.hasCustomizations,[c]=(0,a.useReducer)(d.y,d.u),{serverCart:_}=(0,r.A)(e),I=(0,a.useMemo)((()=>(0,m.iN)(i?.itemPromotionV2?.promotionData)),[i?.itemPromotionV2?.promotionData]),y=(0,a.useMemo)((()=>(0,m._S)(_.data?.items||[])),[_.data?.items]),f=(0,a.useMemo)((()=>_.data?.draftOrderUuid),[_.data?.draftOrderUuid]),C=(0,a.useMemo)((()=>(0,m.o)(i?.itemPromotionV2?.promotionData)),[i?.itemPromotionV2?.promotionData]),D=(0,E.vm)({...p.I.edit_flow_quantity_info_fix,defaultValue:!1}),L=(0,E.vm)({...p.I.bogo_price_calculation_fix,defaultValue:!1});return(0,a.useMemo)((()=>{if(!i||!C)return{totalItems:0,totalFreeItems:0,pdpFreeItems:0,cartFreeItems:0,strikeThroughPrice:0,actualPrice:0,cartItemQuantity:0,draftOrderUUID:""};const t=y[i?.uuid]||0,e=s?t+o:o,a=Math.min(Math.floor(e/2),I);let r,m;s?(m=Math.min(Math.floor(t/2),a),r=m>=I?0:a<I?Math.floor(o/2):a-m):(r=a,m=a);const d=u?null:r;return{totalItems:e,totalFreeItems:a,pdpFreeItems:r,cartFreeItems:m,strikeThroughPrice:(0,l.Qn)({menuItem:{data:i,error:null,isLoading:!1,hasLoaded:!0},customizations:n,quantity:o,itemUpsellState:c,addQuantityInfo:D}),actualPrice:(0,l.EE)({menuItem:{data:i,error:null,isLoading:!1,hasLoaded:!0},customizations:n,quantity:o,itemUpsellState:c,currentFreeItems:d,addQuantityInfo:D,enableBogoPriceCalculationFix:L})??0,cartItemQuantity:t,currentFreeItems:d,draftOrderUUID:f}}),[i,C,o,I,y,c,n,u,s,D,f,L])},y=t=>{let{quantity:e,item:i,store:r,selectedCustomizations:l,isUpdateFlow:d}=t;const{uuid:E,currencyCode:p}=r||{},y=(0,u.A)(),f=(0,o.c)(),C=(0,_.kj)(),D=i.hasCustomizations,L=(0,n.A)("pdp_enable_bogo_sticky_banner"),A=(0,n.A)("pdp_enable_users_for_bogo_sticky_banner"),O=(0,a.useMemo)((()=>(L||A)&&!(d&&D)),[L,A,d,D]),R=(0,a.useMemo)((()=>(0,m.o)(i.itemPromotionV2?.promotionData)),[i.itemPromotionV2?.promotionData]),P=(0,a.useMemo)((()=>(0,m.iN)(i.itemPromotionV2?.promotionData)),[i.itemPromotionV2?.promotionData]),M=(0,a.useCallback)((t=>p&&(0,s.vv)(y,p,t)),[y,p]),{totalItems:S,pdpFreeItems:U,cartFreeItems:b,strikeThroughPrice:N,actualPrice:g,cartItemQuantity:h}=I({item:O?i:null,quantity:e,storeUuid:E,selectedCustomizations:l,isUpdateFlow:d}),T=(0,a.useMemo)((()=>O&&M(g)?[(0,m.EN)(" â€¢ "),(0,m.EN)(M(g)??`${g}`),(0,m.EN)(" "),(0,m.EN)(M(N)??`${N}`,[c.STRIKE_THROUGH])]:[]),[M,g,N,O]),z=(0,a.useMemo)((()=>O?{add_another_item:[(0,m.EN)(f("pdp.stickyBanner.bogo.state.add_item"))],free_items_under_limit_label:[(0,m.EN)(f("pdp.stickyBanner.bogo.state.item_under_limit_label",{x:U})),...S>1?T:[]],free_items_limit_reached_label:h<2*P?[(0,m.EN)(f("pdp.stickyBanner.bogo.state.item_under_limit_label",{x:U})),...S>1?T:[]]:[(0,m.EN)(f("pdp.stickyBanner.bogo.state.free_items_limit_reached.label",{x:b<P?U:P}))],free_items_limit_reached_subtitle:[(0,m.EN)(f("pdp.stickyBanner.bogo.state.free_items_limit_reached.subtitle"))]}:{add_another_item:[],free_items_under_limit_label:[],free_items_limit_reached_label:[],free_items_limit_reached_subtitle:[]}),[f,U,b,S,T,h,P,O]);return R&&O?{pdpBogoStickyBanner:(0,m.kK)({totalItems:S,redemptionCap:P},z,C),scrollFn:()=>{},maxCapReachedInCart:h>=2*P}:{}}},50375:(t,e,i)=>{i.d(e,{f:()=>u});var a=i(74225),o=i(24727),n=i(12741),r=i(47577);function u(t,e){const i=(0,n.A)("getMenuItemV1"),u=(0,a.useQueryClient)(),s=(0,o.n)("getMenuItemV1",t),m=(0,a.useQuery)({queryKey:s,queryFn:t=>{let{queryKey:e}=t;return i.request("getMenuItemV1",e[1])},...e?.queryObserverOptions}),l=Boolean(e.queryObserverOptions?.enabled??!0);return(0,r.A)((()=>!m.isFetched&&l?u.prefetchQuery({queryKey:s,queryFn:t=>{let{queryKey:e}=t;return i.request("getMenuItemV1",e[1])}}):null),[m,i,s,u,l],e.preparedId,(0,a.hashQueryKey)(s)),m}},66197:(t,e,i)=>{i.d(e,{A:()=>n});var a=i(17649),o=i(30505);const n=t=>{const e=(0,o.A)(t),{hasGroupOrder:i,isDraftOrderCartLocked:n,isDraftOrderCreator:r,isDraftOrderParticipant:u,draftOrder:s}=(0,a.A)(t),m=i&&e.cart.data?.storeUuid===t,l=r||!(m&&n),d=u&&m;return{isBundled:Boolean(s?.bundleGroupInfo),hasGroupOrderForStore:m,canEditGroupOrderCart:l,isDraftOrderParticipantForStore:d}}},67152:(t,e,i)=>{i.d(e,{u:()=>a,y:()=>o});const a={itemMap:{},itemsArray:[]};function o(t,e){if("ADD_ITEM_UPSELL"===e.type){const i=e.payload.item,{itemMap:a,itemsArray:o}=t;return a[i.uuid]?{itemMap:{...a,[i.uuid]:a[i.uuid]+1},itemsArray:o}:{itemMap:{...a,[i.uuid]:1},itemsArray:[...o,i]}}if("SUB_ITEM_UPSELL"===e.type){const i=e.payload.item,{itemMap:a,itemsArray:o}=t;if(a[i.uuid]){if(a[i.uuid]>1)return{itemMap:{...a,[i.uuid]:a[i.uuid]-1},itemsArray:o};const t=o.findIndex((t=>t.uuid===i.uuid)),e={...a},n=[...o];return delete e[i.uuid],n.splice(t,1),{itemMap:e,itemsArray:n}}return{itemMap:a,itemsArray:o}}return t}},86943:(t,e,i)=>{i.d(e,{EN:()=>r,_S:()=>n,iN:()=>o,kK:()=>m,o:()=>a});const a=t=>!!t&&("buyXGetYItemPromotion"===t.type&&1===t.buyQuantity&&1===t.getQuantity),o=t=>t?.maxRedemptionCount||0,n=t=>(t||[]).reduce(((t,e)=>({...t,[e.uuid]:(t[e.uuid]||0)+e.quantity})),{});function r(t,e){return{text:{text:t},predefinedDecorations:e}}function u(t){let{style:e="PARAGRAPH_DEFAULT",weight:i="NORMAL",color:a="CONTENT_PRIMARY"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t?.length)return{richTextElements:t.map((t=>{let{text:o,predefinedDecorations:n}=t;return{type:"text",text:{text:{text:o?.text||"",font:{style:e,weight:i},color:a},predefinedDecorations:n}}}))}}function s(t,e){if(e)return{illustrationContent:{illustration:{illustration:{icon:{icon:e,color:t,dimensions:{width:{spacingValue:"SPACING_UNIT_2X",type:"spacingValue"},height:{spacingValue:"SPACING_UNIT_2X",type:"spacingValue"}}},type:"icon"}}},type:"illustrationContent"}}const m=(t,e,i)=>{let a,o,n,r,m,{totalItems:l,redemptionCap:d}=t;return l>=2*d?(a="yellow"===i?"CONTENT_ON_COLOR_INVERSE":"CONTENT_ON_COLOR",o="yellow"===i||"red"===i?"BRAND_BACKGROUND_PRIMARY":"BACKGROUND_POSITIVE",n="CHECKMARK",r=e.free_items_limit_reached_label,m=e.free_items_limit_reached_subtitle,{title:u(r,{style:"LABEL_SMALL",weight:"MEDIUM",color:a}),...m?{subtitle:u(m,{style:"LABEL_X_SMALL",weight:"LIGHT",color:a})}:{},leadingContent:s(a,"CHECKMARK"),hasDivider:!1,size:{fixed:"COMPACT",type:"fixed"},styleAttributes:{backgroundColor:{backgroundColor:o,type:"backgroundColor"}}}):null}}}]);
//# sourceMappingURL=https://sourcemaps.uberinternal.com/raw/web-eats-v2/client-31288-dba7ce3c9fff77bf.js.map