"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[63536],{2195:(t,e,r)=>{r.d(e,{A:()=>m});var i=r(90417),a=r(86105),n=r(8474),s=r(35152),o=r(36291),u=r(71715),c=r(5230),d=r(41519),l=r(38659),I=r(69460);function m(){const{isEditItemModalActive:t,isFullPageMulticartSwitcherEntrypoint:e}=(0,s._l)((t=>{const{modalName:e,entryPoint:r}=(0,n.g$k)(t,["modalName","entryPoint"]);return{isEditItemModalActive:"editItem"===e,isFullPageMulticartSwitcherEntrypoint:"full-page-multicart-switcher"===r}})),r=(0,a.W6)(),{totalOrders:m}=(0,u.A)(),U=(0,o.A)(),f=(0,c.A)(),p=(0,d.A)(),O=(0,l.A)();return(0,i.useCallback)((i=>{if(f&&e)U({type:"MODAL_CLOSE"});else if(p&&1===r.length)O(I.kw);else if(t&&i)f&&r.length>2?r.go(-2):r.replace(i);else if(2===m)r.goBack();else if(m>2){const t=r.location.state?.clearLocation;t?r.replace((0,n.Zyy)(t,"multicartMobileSwitcher")):r.goBack()}}),[f,e,t,m,U,O,p,r])}},12150:(t,e,r)=>{r.d(e,{A:()=>S});var i=r(90417),a=r(91156),n=r(98912),s=r(41908),o=r(8700),u=r(30505),c=r(89864),d=r(86105),l=r(37036),I=r(12615),m=r(317),U=r(8474);var f=r(68279),p=r(37959),O=r(89831),_=r(53728),A=r(11135),y=r(62461),E=r(41568),T=r(78275),h=r(2195),D=r(5230),b=r(31725),C=r(66433);const g=()=>{const t=(0,b.A)("prevent_clear_cart_redirect_enabled"),e=!(0,C.k)().isMobile;return t&&e};function S(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cart";const{notifyExternalSyncToCart:e,notifyDiscardedOrder:r}=(0,E._)(),b=(0,d.W6)(),C=(0,l.A)(),S=function(){const t=(0,d.W6)(),e=(0,I.A)(),r=(0,m.A)();return(0,i.useCallback)((()=>e?(0,U.lGi)(t.location,{deliveryLocation:e,time:r}):(0,U.aUB)(t.location)),[t,e,r])}(),v=(0,a.Ay)(),P=(0,O.wA)(),M=(0,_.A)(),k=(0,h.A)(),B=(0,D.A)(),{isCartDrafting:R}=(0,T.A)(),{draftOrderUUID:L,serverCart:w,isBundledOrder:N,isGroupOrderParticipant:Q,isEditOrder:x}=(0,s.tC)(),W=(0,u.A)(),{closeSidebarCart:q}=(0,c.lK)(),{isStorePrecheckoutBundlingEnabled:G}=(0,y.A)(),{store:F}=(0,o.Ay)(w.data?.storeUuid),Y=F.data,V=g(),{mutate:H}=(0,A.Q)("removeItemsFromDraftOrderV2",L||""),{mutate:z}=(0,A.Q)("removeItemsFromGroupDraftOrderV2",L||""),$=(0,f.A)("remove_all_items");return(0,i.useCallback)((async(i,a)=>{let{shoppingCartItemUUIDs:s}=i;if(Y&&(v("eats:remove_from_cart_action_start",{store:(0,n.WT)(Y),cartUuid:W?.cartUUID||"",itemUuids:s,draftOrderUuid:L||"",isGroupOrderParticipant:Q,isEditScheduledOrder:x,source:t}),s.forEach((e=>{const r=(w.data?.items||[]).find((t=>t.shoppingCartItemUuid===e));v("eats:remove_from_cart",{store:(0,n.WT)(Y),cartItemUuids:(w.data?.items||[]).map((t=>t.shoppingCartItemUuid)),cartUuid:W?.cartUUID||"",cartItem:r,draftOrderUuid:L||"",isGroupOrderParticipant:Q,isEditScheduledOrder:x,source:t,isDrafting:R})})),W?.cartUUID))if(W.isGroupOrder)await z({cartUUID:W.cartUUID,draftOrderUUID:W.draftOrderUUID,shoppingCartItemUUIDs:s,storeUUID:W.storeUUID}),e({cartId:W.draftOrderUUID??"",storeId:Y.uuid});else if(w.data?.items.length===s.length){if(x)return q(),P((0,p.RO)(W.storeUUID||"",w.data?.items[0]?.uuid||"",w.data?.items[0]?.quantity||1)),void b.push((0,U.lY_)(b.location));if(G&&N)b.push((0,U.Zyy)(b.location,"bundledOrderDiscard",{draftOrderUUID:L}));else{q(),await $(),r({storeId:W.storeUUID??""});const t=(0,U.NQI)(b.location,(0,U.oLA)(Y));if(C){if(M)return void b.replace(t);b.replace(S())}else{!a?.isQuickAdd&&!V&&k(t)}}}else await H({cartUUID:W.cartUUID,draftOrderUUID:W.draftOrderUUID,shoppingCartItemUUIDs:s,storeUUID:W.storeUUID,actionMeta:a,locationType:Y.location?.locationType}),e({cartId:W.draftOrderUUID??"",storeId:Y.uuid})}),[Y,W,w.data?.items,v,L,$,C,B,b,S,U.oLA,U.NQI,M,H,z,Q,t])}},19589:(t,e,r)=>{r.d(e,{A:()=>S});var i=r("__fusion__95b4ba69e5"),a=r(89864),n=r(91156),s=r(11752),o=r(73077),u=r(41908),c=r(17649),d=r(98912),l=r(30505),I=r(37036),m=r(12150),U=r(97887),f=r(8700),p=r(89831),O=r(37959),_=r(35508),A=r(7139),y=r(11135),E=r(76366),T=r(82801),h=r(41568),D=r(66371),b=r(85951),C=r(22121),g=r(50685);function S(t,e,r){const{notifyExternalSyncToCart:S}=(0,h._)(),{closeSidebarCart:v}=(0,a.lK)(),P=(0,n.Ay)(),M=(0,s.A)(),k=(0,o.fe)(M),{serverCart:B}=(0,u.B_)(),{store:R}=(0,f.Ay)(B.data?.storeUuid),L=(0,g.mD)(R?.data?.location?.locationType),{mutate:w}=(0,y.Q)("updateItemInDraftOrderV2",k||""),{mutate:N}=(0,y.Q)("updateItemInGroupDraftOrderV2",k||""),Q=(0,l.A)(),{hasGroupOrder:x,isEditOrder:W,isDraftOrderParticipant:q}=(0,c.A)(),G=(0,I.A)(),F=(0,m.A)(),Y=(0,p.wA)(),V=i.useRef(!1),H=(0,U.g)(),{stopTiming:z}=(0,D.zR)(),{outOfItemAction:$,backupProduct:J,specialInstructions:K,selectionSource:j}=(0,C.A)();i.useEffect((()=>{0!==B.data?.items.length||x||v(),!B.isLoading&&B.hasLoaded&&(B.error&&V.current&&!G?(H(!1,B.error,!1,R),V.current=!1):e&&V.current&&!G&&(V.current=!1,H(!1,null,!1,R,!0)))}));const Z=i.useCallback((async(t,e,i,a,n)=>{const{data:s}=R;if(!s||!t)return;const o=r&&s.fulfillmentIssueOptions&&$,u=o&&"SUBSTITUTE_ITEM"===$&&J?[{sectionUUID:J.sectionUUID,subsectionUUID:J.subsectionUUID,title:J.title,quantity:e,storeUUID:s.uuid,skuUUID:J.itemUUID}]:null,c={...t,quantity:e,...o?{fulfillmentIssueAction:{type:$,selectionSource:j,itemSubstitutes:u}}:null,...K?{specialInstructions:K}:{}},{pricedByUnit:l,soldByUnit:I,soldByWeight:m}=(0,A.zO)(c),U={prevQuantity:t.quantity,quantity:e,store:(0,d.WT)(s),isGroupOrderParticipant:q,isEditScheduledOrder:W,...l&&{pricedByUnit:l},...I&&{soldByUnit:I},...t?{cartItem:t}:{},...k?{draftOrderUuid:k}:{}};P("eats:update_cart_item_quantity",U),c?.itemQuantity?.inSellableUnit&&(a||(a=_.R9.from(c.quantity).toBaseDecimal()),c.quantity=m?1:_.R9.from(a).toInt(),c.itemQuantity.inSellableUnit.value={coefficient:a.base,exponent:a.exponent});const f=n===E.g.STOREFRONT&&i?.isQuickAdd?{draftOrderPresentationSourceType:T.BK.QUICK_ADD_STOREFRONT}:void 0,p=L?{imageURL:t.imageURL}:void 0;V.current=!0,Q&&Q.cartUUID&&(Q.isGroupOrder?await N({draftOrderUUID:Q.draftOrderUUID,cartUUID:Q.cartUUID,item:c}):await w({draftOrderUUID:Q.draftOrderUUID,cartUUID:Q.cartUUID,item:c,writeInItemOverrides:p,actionMeta:i,...f&&{draftOrderPresentationContext:f}}),z(`${b.s.UPDATE_ITEM_QUANTITY}_${c.uuid||""}`,{shouldEmitTiming:!0,overrideLabelFn:()=>b.s.UPDATE_ITEM_QUANTITY}),z(`${b.s.UPDATE_ITEM_QUANTITY_WITH_DEBOUNCE}_${c.uuid||""}`,{shouldEmitTiming:!0,overrideLabelFn:()=>b.s.UPDATE_ITEM_QUANTITY_WITH_DEBOUNCE}),S({cartId:Q.draftOrderUUID??"",storeId:s.uuid}))}),[R,r,$,J,q,W,k,P,Q,z,S,N,w,L,K,j]);return i.useCallback(((e,r,i,a)=>{const n=(B.data?.items||[]).find((t=>t.shoppingCartItemUuid===e));n&&!t&&Y((0,O.Ag)(n.uuid)),r?"number"==typeof r?Z(n,r,i,null,a):Z(n,r.base/Math.pow(10,Math.abs(r.exponent)),i,r,a):F({shoppingCartItemUUIDs:[e]},i)}),[t,Y,F,B.data,Z])}},22121:(t,e,r)=>{r.d(e,{A:()=>u});var i=r("__fusion__95b4ba69e5"),a=r(89831),n=r(65416),s=r(27435),o=r(58410);const u=()=>{const t=(0,a.wA)(),e=(0,n.d4)((t=>{let{outOfItems:e}=t;return e})),{backupProduct:r,outOfItemAction:u,specialInstructions:c,unsavedOutOfItemAction:d,selectionSource:l}=e,I=i.useCallback((e=>{t((0,s.ol)(e||"REMOVE_ITEM"))}),[t]),m=i.useCallback((e=>{t((0,s.Rl)(e||"REMOVE_ITEM"))}),[t]),U=i.useCallback((e=>{t((0,s.RH)(e))}),[t]),f=i.useCallback((e=>{t((0,s.sw)(e||""))}),[t]),p=i.useCallback((e=>{t((0,s.rj)(e))}),[t]),O=i.useCallback((e=>t((0,s.iX)(e))),[t]),_=i.useCallback((e=>{t((0,s.pP)(e))}),[t]),A=i.useCallback((e=>{let{item:r,fulfillmentIssueOptions:i}=e;const a=r?.fulfillmentIssueAction?.itemSubstitutes;"ACTION_SHEET"===i?.fulfillmentIssueDisplayType?(I(r?.fulfillmentIssueAction?.type),_(r?.fulfillmentIssueAction?.selectionSource?r?.fulfillmentIssueAction?.selectionSource:o.vV.UBER_SUGGESTED),a&&t((0,s.RH)(a[0]))):t((0,s.Pc)())}),[t,I,_]),y=i.useCallback((()=>t((0,s.Pc)())),[t]);return{outOfItemAction:u,updateOutOfItemAction:I,backupProduct:r,updateBackupProduct:U,specialInstructions:c.instructions,specialInstructionsState:c,updateSpecialInstructions:f,unsavedOutOfItemAction:d,updateUnsavedOutOfItemAction:O,updateDefaultOutOfItemAction:m,setOutOfItemsStateWithItemPayload:A,setInitialSpecialInstructions:p,resetReplacementPreferencesAndNotes:y,selectionSource:l,updateSelectionSource:_}}},37036:(t,e,r)=>{r.d(e,{A:()=>a});var i=r(35152);function a(){return(0,i._l)((t=>Boolean(t.pathname?.includes("/checkout"))))}},47916:(t,e,r)=>{r.d(e,{o:()=>O,A:()=>_});var i=r("__fusion__95b4ba69e5"),a=r(4914),n=r(74642),s=r(90417),o=r(39155),u=r(40014);function c(t,e){return(0,u.Y)(o.A,{viewBox:"0 0 24 24",ref:e,...t,children:(0,u.Y)("path",{d:"M12 1C5.9 1 1 5.9 1 12s4.9 11 11 11 11-4.9 11-11S18.1 1 12 1zm6 12.5H6v-3h12v3z"})})}const d=s.forwardRef(c);var l=r(31725),I=r(6198),m=r(91156),U=r(41908),f=r(97462),p=r(69616);const O={BELOW_LIMIT:-1,EQUAL_TO_LIMIT:0,ABOVE_LIMIT:1},_=t=>{let{item:e,storeUuid:r,counterQuantity:s=0,counterAdjustment:o=0,cartQuantity:c,overrideQuantityConstraints:_=null,measurementType:A=e&&"purchaseInfo"in e&&e?.purchaseInfo?.purchaseOptions?.length&&e.purchaseInfo.purchaseOptions?.[0]?.soldByUnit?.measurementType||p.Jf.MEASUREMENT_TYPE_COUNT}=t;const y=e?.uuid,E=(0,I.Ay)(y||void 0,!1),[T]=i.useState(o),{enqueue:h}=(0,n.dh)(),D=(0,a.c)(),b=_?_.maxPermittedNumber:(0,f.i)(e,A),C=A===p.Jf.MEASUREMENT_TYPE_WEIGHT,g=A===p.Jf.MEASUREMENT_TYPE_COUNT,S=(0,l.A)("price_items_by_weight"),v=(0,l.A)("item_quantity_limits"),P=v&&S&&C||v&&g,M="number"==typeof c?c:E,{serverCart:k}=(0,U.B_)(),B=(0,m.Ay)();return i.useCallback((function(){let{increment:t=0,showSnackbarWarning:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=M+(s-T)+t;return P&&"number"==typeof b&&"string"==typeof y?(i>=b&&t>0&&(e&&h({message:D("item_quantity_limits.limit_reached"),startEnhancer:t=>{let{size:e}=t;return(0,u.Y)(d,{size:e})}}),B("eats:selected_item_quantity_limit_reached",{draftOrderUuid:k.data?.draftOrderUuid??"",menuItemUuid:y,...r&&{storeUuid:r}})),i<b?O.BELOW_LIMIT:i===b?O.EQUAL_TO_LIMIT:O.ABOVE_LIMIT):O.BELOW_LIMIT}),[M,T,s,B,P,h,y,b,k,r,D])}},97462:(t,e,r)=>{r.d(e,{i:()=>o});var i=r(69616),a=r(49942),n=r(35508),s=r(7139);const o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t&&"purchaseInfo"in t&&1===t.purchaseInfo?.purchaseOptions?.length&&t.purchaseInfo.purchaseOptions[0]?.soldByUnit?.measurementType||i.Jf.MEASUREMENT_TYPE_COUNT;if(t&&"purchaseInfo"in t&&t.purchaseInfo?.purchaseOptions){const r=t.purchaseInfo.purchaseOptions.find((t=>t.soldByUnit?.measurementType===e)),i=r&&r.quantityConstraintsV2;if(i?.maxPermitted)return"number"==typeof i.maxPermitted.base?n.R9.from(i.maxPermitted).toFloat():(0,a.oc)(i.maxPermitted)}else if(t&&"sellingOption"in t){const e=(0,s.VO)(t.sellingOption?.quantityConstraints);if(e?.maxPermitted)return"number"==typeof e.maxPermitted.base?n.R9.from(e.maxPermitted).toFloat():(0,a.oc)(e.maxPermitted)}return null}}}]);
//# sourceMappingURL=https://sourcemaps.uberinternal.com/raw/web-eats-v2/client-63536-5deab20a07305baa.js.map