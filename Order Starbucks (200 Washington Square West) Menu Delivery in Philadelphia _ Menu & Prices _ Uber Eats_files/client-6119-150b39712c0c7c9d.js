"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[4306,6119],{636:(e,t,r)=>{r.d(t,{A:()=>d});var i=r(87731),o=r(17649),n=r(56489);const a=6e4;function d(e,t){const r=(0,o.A)(),d=(0,i.A)(),l=t||r.deliveryTime||{};if(!e?.lockAtInMs&&!e?.lockBeforeScheduledInMinutes)return null;if(e.lockAtInMs)return(0,n.ww)(d,e.lockAtInMs);if("number"==typeof e.lockBeforeScheduledInMinutes&&l.scheduled){const t=e.lockBeforeScheduledInMinutes*a,r=(0,n.zz)(l.date)||new Date;return(0,n.KT)(r,l.startTime),(0,n.ww)(d,r-t)}}},7628:(e,t,r)=>{r.d(t,{m:()=>a});var i=r(68994),o=r(32879),n=r(65416);const a=()=>{const e=(0,n.d4)((e=>{let{draftOrder:t}=e;return t})),t=Boolean(e.draftOrder.data?.draftOrder.businessDetails?.voucherUUID),r=(0,o.q5)("total"),{selectedPersonalPayment:a,selectedBusinessPayment:d,paymentIntent:l,currentStep:s}=(0,i.b8)(),c=t&&0===r.data?.total.value.amountE5,u=Boolean("personal"===l&&(a?.uuid||c)),h=Boolean("business"===l&&"COMPLETE"===s&&d?.paymentProfileUuid);return{hasValidPayment:u||h,validPersonalPayment:u,validBusinessPayment:h}}},7903:(e,t,r)=>{r.d(t,{A:()=>u});var i=r(77644),o=r(35225),n=r(39216),a=r(41908),d=r(86879),l=r(31725),s=r(97452),c=r(40014);const u=e=>{let{store:t,draftOrder:r,loaded:u,isLiveOrder:h=!1}=e;const p=(0,i.A)(),{isBundledOrder:m}=(0,a.tC)(),{cmpQuery:f}=(0,d.A)(),_=(0,l.A)("canonical_product_smart_cart"),y=t.isLoading||r?.isLoading||m&&!f.isFetched,g=Boolean(t.hasLoaded)&&Boolean(r?.hasLoaded),A=Boolean(t.data)&&Boolean(r?.data),v=t.error||r?.error,Y=!_||f.isFetched;return h?t.error&&!t.data?(0,c.Y)(s.jO,{code:500}):t.data&&h&&Y?(0,c.Y)(c.FK,{children:u(t.data,null)}):(0,c.Y)(o.A,{}):y&&!g?(0,c.Y)(o.A,{}):v&&!A?(0,c.Y)(n.A,{error:v,onClickTryAgain:p}):g&&!A?(0,c.Y)(n.A,{error:new Error("Request finished without loading any data"),onClickTryAgain:p}):t.data&&r?.data&&Y?(0,c.Y)(c.FK,{children:u(t.data,r?.data)}):(0,c.Y)(o.A,{})}},9639:(e,t,r)=>{r.d(t,{C:()=>$});var i=r("__fusion__95b4ba69e5"),o=r(32879),n=r(41967),a=r(37556),d=r(21059),l=r(66433),s=r(61073),c=r(71435),u=r(39027),h=r(4914),p=r(66764),m=r(65714),f=r(89831),_=r(65416),y=r(57078);var g=r(91156),A=r(54960),v=r(93720),Y=r(25263),b=r(21499),I=r(41046),C=r(55018),S=r(36106),w=r(74642),O=r(34646),D=r("__fusion__e5990cf4f7"),M=r(40014);const k=(e,t)=>{const r=e?t.sizing.scale600:0,i=e?0:t.sizing.scale800;return`${r} ${i} ${t.sizing.scale600} ${i}`},E=(0,n.I4)("div",(e=>{let{$theme:t,$isMobile:r=!1}=e;return{margin:k(r,t)}})),T=e=>{let{defaultSelectedStoreUuid:t}=e;const{cmpQuery:r}=(0,o.Ay)(["storeSwitcherActionableBannerPayload"]),n=i.useRef(!1),a=(0,g.Ay)(),{isMobile:d}=(0,l.k)(),{enqueue:c}=(0,w.dh)(),u=(0,h.c)(),p=i.useCallback((e=>{c({message:u("smart_cart.banner_snackbar.text",{storeName:e}),startEnhancer:()=>(0,M.Y)(D.default,{})},O.f.short)}),[c,u]),{onSelectStore:m}=(0,S.T)(t);return(0,M.Y)(s.n,{source:r,enableLoadingForRefetch:!0,loading:()=>null,error:()=>null,loaded:e=>{const t=e?.checkoutPayloads?.storeSwitcherActionableBannerPayload;t?.actionableBanner&&!n.current&&(a("eats:smart_cart_switch_suggestion_shown",{suggestedStorePosition:"unknown"}),n.current=!0);const r=t?.actionableBanner?.actionMetadata,i=r?.switchStoreMetadata;return t?.actionableBanner?.bannerModel?(0,M.Y)(E,{$isMobile:d,children:(0,M.Y)(C.A,{viewModel:t.actionableBanner?.bannerModel,onClick:()=>{i?.storeWithProduct&&(a("eats:smart_cart_switch_suggestion_click"),m(i?.storeWithProduct),p(i?.storeWithProduct?.merchantName))},noMargin:!0})}):null}})},B="uev2.smart-cart-ftux-tooltip.seen",P=(0,n.I4)("div",(e=>{let{$theme:t,$isMobile:r=!1}=e;return{margin:`${r?t.sizing.scale600:0} 0 0 0 !important`}})),U=(0,n.I4)("div",(e=>{let{$theme:t}=e;return{padding:`${t.sizing.scale400} 0`,width:"256px",display:"flex",justifyContent:"space-between",alignItems:"center",...t.typography.ParagraphSmall}})),L=(0,n.I4)(Y.A,{cursor:"pointer"}),$=e=>{let{defaultSelectedStoreUuid:t}=e;const{cmpQuery:r}=(0,o.Ay)(["canonicalProductStorePickerPayload"]),{onSelectStore:n,isLoading:Y,error:C,resetErrorState:w}=(0,S.T)(t),{isMobile:O}=(0,l.k)(),D=(0,h.c)(),[k,E]=i.useState(!1);i.useEffect((()=>{const e=(0,b.bu)(B);(0,I.A)(e)&&E(!0),(0,I.A)(e)&&k&&(0,b.Vv)(B,{seen:!0})}),[k]);const $=(0,g.Ay)(),R=i.useRef(!1),x=(0,f.wA)(),F=(0,_.d4)((e=>e?.smartCart?.hasPreviouslyLoaded||!1)),N=(0,_.d4)((e=>e?.smartCart?.storeWithProducts||[])),z=(0,_.d4)((e=>e?.smartCart?.scrollPosition||0));return Y?(0,M.Y)(a.I,{}):C?(0,M.Y)(c.A,{isOpen:Boolean(C),heading:D("components.genericError.title"),buttonDock:{primaryAction:(0,M.Y)(m.$n,{onClick:()=>{w()},children:D("ducks.uiModalAlertGeneric.defaultConfirmLabel")?.toUpperCase()})},children:(0,M.Y)(u.oS,{children:(0,M.Y)(p.H,{id:"shared.genericServerError"})})}):(0,M.Y)(s.n,{source:r,enableLoadingForRefetch:!0,loading:()=>F?(0,M.Y)(a.I,{}):null,error:()=>null,loaded:e=>{const r=e?.checkoutPayloads?.canonicalProductStorePickerPayload?.storesWithProductPayload;r?.storesWithProduct&&!R.current&&($("eats:smart_cart_shown"),R.current=!0);let i=r?.storesWithProduct;return i&&r?.defaultSelectedStoreUuid?(F||(i=((e,t)=>{const r=e.find((e=>e.storeUuid===t));return r&&(e.splice(e.indexOf(r),1),e.unshift(r)),e})(i,r?.defaultSelectedStoreUuid)),F&&N&&(i=((e,t,r)=>{const i=e.findIndex((e=>e.storeUuid===r)),o=t.find((e=>e.storeUuid===r)),n=t.sort(((t,r)=>{const i=e.findIndex((e=>e.storeUuid===t.storeUuid)),o=e.findIndex((e=>e.storeUuid===r.storeUuid));return(-1===i?Number.MAX_SAFE_INTEGER:i)-(-1===o?Number.MAX_SAFE_INTEGER:o)}));return o&&i>2&&(n.splice(n.indexOf(o),1),n.unshift(o)),n})(N,i,r?.defaultSelectedStoreUuid),i[0]?.storeUuid===r?.defaultSelectedStoreUuid&&z>0&&x((0,y.Sc)(0))),(0,M.Y)(A.A,{content:()=>(0,M.FD)(U,{children:[(0,M.Y)(p.H,{id:"smart_cart.ftux_tooltip.text"}),(0,M.Y)(L,{onClick:()=>E(!1)})]}),showArrow:!0,placement:O?v.El.bottom:v.El.bottomLeft,isOpen:k,overrides:{Body:{style:e=>{let{$theme:t}=e;return{marginLeft:O?0:t.sizing.scale800}}}},children:(0,M.FD)(P,{$isMobile:O,children:[(0,M.Y)(T,{defaultSelectedStoreUuid:t}),(0,M.Y)(d.A,{displayType:"horizontal",storesWithProducts:i,onSelectStore:e=>{if(e.storeUuid===r?.defaultSelectedStoreUuid)return;F||x((0,y.lQ)()),i&&x((0,y.IP)(i));const t=r?.storesWithProduct?.findIndex((t=>t.storeUuid===e?.storeUuid));$("eats:smart_cart_store_switched",{positionOfSelectedStore:t?.toString()||"unknown",signposts:e?.tags&&e?.tags[0]?.text?e?.tags[0]?.text:""}),n(e)},expansionMode:"show_all",defaultSelectedStoreUuid:r?.defaultSelectedStoreUuid,title:r.title,isInCart:!0,isMobile:O})]},e?.draftOrderUUID)})):null}})}},14367:(e,t,r)=>{r.d(t,{A:()=>d});var i=r(90417),o=r(39155),n=r(40014);function a(e,t){return(0,n.Y)(o.A,{viewBox:"0 0 20 20",ref:t,...e,children:(0,n.Y)("path",{d:"M12 5.5L14.5 8 4.165 18.333h-2.5v-2.5L11.999 5.5zM15.893 1.658L13.83 3.72l2.475 2.475 2.062-2.063-2.475-2.474z"})})}const d=i.forwardRef(a)},26118:(e,t,r)=>{r.d(t,{A:()=>a});var i=r(90417),o=r(41908),n=r(71715);const a=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{isBundledOrder:t,draftOrderUUID:r,primaryDraftOrderUUID:a}=(0,o.tC)(),{setActiveDraftOrder:d}=(0,n.A)();(0,i.useEffect)((()=>{e&&t&&r!==a&&d(a)}),[e,r,t,a,d])}},29077:(e,t,r)=>{r.d(t,{A:()=>_});var i=r(75674),o=r(61073),n=r(77692),a=r(66764),d=r(87731),l=r(17649),s=r(41967),c=r(63919),u=r(40509),h=r(41908),p=r(40014);const m=(0,s.I4)("span",(e=>{let{$theme:t}=e;return{...t.typography.ParagraphSmall,color:t.colors.contentTertiary}})),f=(0,s.I4)("span",(e=>{let{$theme:t}=e;return{...t.typography.LabelMedium,color:t.colors.contentPrimary}})),_=()=>{const e=(0,d.A)(),{draftOrderMaybe:t}=(0,h.tC)(),{hasGroupOrder:r}=(0,l.A)(),s=(0,u.A)();return r?(0,p.Y)(o.A,{source:t,loaded:t=>{const r=t.spendingLimitAmount,i=r.currencyCode;if(!r||!i)return null;const o=r.amount,d=(0,n.vv)(e,i,o);return(0,p.Y)(p.FK,{children:s?(0,p.FD)(p.FK,{children:[(0,p.Y)(c.A,{spaces:2,color:"contentTertiary"}),(0,p.Y)(f,{children:(0,p.Y)(a.H,{id:"go.spending_limit",data:{spendingLimit:d}})})]}):(0,p.FD)(p.FK,{children:[(0,p.Y)(c.A,{spaces:2,color:"contentTertiary"}),(0,p.Y)(m,{children:(0,p.Y)(a.H,{id:"go.spending_limit_summary.v2",data:{spendingLimit:d}})})]})})},error:()=>null,loading:()=>(0,p.Y)(i.bu,{$width:"200px"})}):null}},54246:(e,t,r)=>{r.d(t,{A:()=>w,n:()=>S});var i=r(66764),o=r(39027),n=r("__fusion__f7752de559"),a=r(41967),d=r(73939),l=r(2693),s=r(9628),c=r(4442),u=r(17649),h=r(57716),p=r(8474),m=r(86105),f=r(32879),_=r(21635),y=r(40014);const g=(0,a.I4)("div",(e=>({display:"flex",flexDirection:"row",padding:"24px 0 16px",borderBottom:`1px solid ${e.$theme.colors.borderOpaque}`}))),A=(0,a.I4)("div",(e=>{let{$theme:t}=e;return{...t.typography.ParagraphSmall,color:t.colors.contentSecondary}})),v=(0,a.I4)("div",{display:"flex",fledDirection:"column",alignItems:"center",justifyContent:"center"}),Y=(0,a.I4)("div",{flexGrow:"1"}),b={$width:"21px"},I=()=>{const[,e]=(0,a.c6)(),t=(0,m.zy)();return(0,y.FD)(g,{children:[(0,y.Y)(v,{children:(0,y.Y)(n.default,{size:21,color:e.colors.contentNegative})}),(0,y.Y)(l.IW,{...b}),(0,y.FD)(Y,{children:[(0,y.Y)(o.w_,{children:(0,y.Y)(i.H,{id:"go.multicart.invalid.item.heading"})}),(0,y.Y)(o._I,{color:e.colors.contentSecondary,children:(0,y.Y)(i.H,{id:"go.multicart.invalid.item.subtext"})})]}),(0,y.Y)(l.IW,{$width:e.sizing.scale600}),(0,y.Y)(v,{children:(0,y.Y)(d.BM,{$as:h.N_,to:(0,p.Zyy)(t,"invalidItems"),children:(0,y.Y)(i.H,{id:"ro.label.view"})})})]})},C=e=>{let{error:t}=e;const{hasGroupOrder:r,isDraftOrderCreator:c}=(0,u.A)(),[,h]=(0,a.c6)(),p=(0,s.N)(t),m=(0,s.gr)(t);return p&&0!==m.length?r&&c?(0,y.Y)(I,{}):(0,y.FD)(g,{children:[(0,y.Y)(v,{children:(0,y.Y)(n.default,{size:21,color:h.colors.contentNegative})}),(0,y.Y)(l.IW,{...b}),(0,y.FD)(Y,{children:[(0,y.Y)(o.w_,{children:(0,y.Y)(i.H,{id:"multicart.invalid_items_proceed"})}),(0,y.Y)(A,{children:m.join(", ")})]}),(0,y.Y)(l.IW,{$width:h.sizing.scale600}),(0,y.Y)(v,{children:(0,y.Y)(d.BM,{onClick:p,children:(0,y.Y)(i.H,{id:"shared.remove"})})})]}):null},S=e=>{const t=e=>e&&e.some((e=>e.cartItemActions&&e.cartItemActions.some((e=>"SCHEDULE"===e.cartItemActionType))));return e.cartItems?t(e.cartItems):!!e.cartItemsGroups&&t(e.cartItemsGroups.flatMap((e=>e.cartItems)))},w=()=>{const e=(0,c.Ay)(),t=(0,_.A)(),{cartItems:r}=(0,f.Ay)(["cartItems"]).checkoutPayloads;return!e||!r||t&&r&&S(r)?null:"UNAVAILABLE_ITEMS"===e.type?(0,y.Y)(C,{error:e}):null}},63887:(e,t,r)=>{r.d(t,{A:()=>S});var i=r(50371),o=r(4914),n=r(8474),a=r(41967),d=r(11873),l=r(90417),s=r(39155),c=r(40014);function u(e,t){return(0,c.Y)(s.A,{viewBox:"0 0 24 24",ref:t,...e,children:(0,c.Y)("path",{d:"M12 1C5.9 1 1 5.9 1 12s4.9 11 11 11 11-4.9 11-11S18.1 1 12 1zm6 13h-8V4h3v7h5v3z"})})}const h=l.forwardRef(u);var p=r(2693),m=r(17649),f=r(14367),_=r(44580),y=r(636),g=r(59160),A=r(66039),v=r(86105);const Y=(0,a.I4)("button",(e=>{let{disabled:t,$theme:r}=e;return{...(0,d.A)({$theme:r}),background:r.colors.backgroundSecondary,justifyContent:"left",display:"flex",flexDirection:"row",cursor:t?"default":"pointer"}})),b=(0,a.I4)("div",(e=>{let{$textDirection:t}=e;return{display:"flex",flexDirection:"column",alignItems:"flex-start",textAlign:"ltr"===t?"left":"right"}})),I=(0,a.I4)("div",(e=>{let{$theme:t}=e;return{...t.typography.LabelMedium}})),C=(0,a.I4)("div",{marginLeft:"auto"}),S=e=>{const t=(0,v.zy)(),r=(0,i.W6)(),a=(0,o.c)(),d=(0,m.A)(),l=d.isDraftOrderCreator,{cartLockOptions:s}=d||{},u=(0,y.A)(s?.deadline),S=(0,g.jH)(),w=u?s?.deadline.lockBeforeScheduledInMinutes||!l?a("go.order_by.date_and_time",{shortDateTime:u}):a(s?.autoSubmit?"go.order_will_be_placed_automatically":"go.deadline.gobs.text",{shortDateTime:u}):null;return(0,c.FD)(c.FK,{children:[(0,c.FD)(Y,{onClick:()=>{r.push((0,n.Zyy)(t,"editGroupOrderDeadline"))},disabled:!l,children:[(0,c.Y)(h,{size:22}),(0,c.Y)(p.VX,{}),(0,c.Y)(b,{$textDirection:S,children:(0,c.Y)(I,{children:s?.deadline.lockAtInMs||s?.deadline.lockBeforeScheduledInMinutes?w:a("go.no_order_deadline")})}),l?(0,c.FD)(c.FK,{children:[(0,c.Y)(p.VX,{}),(0,c.Y)(C,{children:(0,c.Y)(f.A,{size:16,color:"contentInverseTertiary"})})]}):null]}),(0,c.Y)(_.Ay,{$height:24}),(0,c.Y)(A.T,{gutterWidth:e.gutterWidth})]})}},64893:(e,t,r)=>{r.d(t,{A:()=>We});var i=r(90417),o=r(41967),n=r(77977),a=r(69338),d=r(31725),l=r(78275),s=r(32879),c=r(90048),u=r(50371),h=r(86105),p=r(91156),m=r(49807),f=r(26955),_=r(8474),y=r(40304),g=r(51610),A=r(40014);const v=(0,o.I4)("div",(e=>{let{$theme:t}=e;return{boxShadow:t.lighting.shallowAbove,backgroundColor:t.colors.secondary,cursor:"pointer"}})),Y=()=>{const e=(0,u.W6)(),t=(0,h.zy)(),{isCartDrafting:r}=(0,l.A)(),{passBannerOnCartPayload:o}=(0,s.Ay)([...r?["passBannerOnCartPayload"]:[]]).checkoutPayloads,n=(0,p.Ay)(),a=o?o.oneClickMembershipBannersOnCartFooter:null,d=a?a[0]:{},Y=d?.bannerViewModel,b=d?.passCampaign,I=d?.accessPoint,C=d?.membershipAnalyticsMeta,S=d?.deeplink,w=(0,y.vm)({...g.Y.membership_cart_banner,defaultValue:!1});let O;if("listContentViewModel"===Y?.type)O=Y.listContentViewModel;const D=S?.includes("campaign=upsell_lite_optin"),M=D&&w||!D;return(0,i.useEffect)((()=>{O&&M&&n("eats:membership_cart_banner_impression",{...(0,m.CE)(f.K$.MEMBERSHIP_CART_BANNER,C??{},I??f.rm.UNKNOWN,b??f.QQ.UNKNOWN)})}),[I,n,C,b,O,M]),O&&M?(0,A.Y)(v,{children:(0,A.Y)(c.A,{viewModel:O,onClick:()=>{n("eats:membership_cart_banner_click",{...(0,m.CE)(f.K$.MEMBERSHIP_CART_BANNER,C??{},I??f.rm.UNKNOWN,b??f.QQ.UNKNOWN)}),e.push((0,_.uTB)(S??""),{previousLocation:{pathname:t.pathname}})}})}):null};var b=r(66764),I=r(57716),C=r(46692),S=r(97872),w=r(31300),O=r(39155);function D(e,t){return(0,A.Y)(O.A,{viewBox:"0 0 22 22",ref:t,...e,children:(0,A.Y)("path",{d:"M15.8 12.5c-4 0-7.2-3.2-7.2-7.2 0-2.1.9-3.9 2.2-5.2C4.8 0 .1 4.8.1 10.6s4.7 10.5 10.5 10.5c5.7 0 10.6-4.6 10.5-10.7-1.4 1.2-3.3 2.1-5.3 2.1z"})})}const M=i.forwardRef(D);function k(e,t){return(0,A.FD)(O.A,{viewBox:"0 0 24 24",ref:t,...e,children:[(0,A.Y)("path",{d:"M22.01 15.01L20 17.02l-2.01-2.01-1.98 1.98L18.02 19l-2.01 2.01 1.98 1.98L20 20.98l2.01 2.01 1.98-1.98L21.98 19l2.01-2.01-1.98-1.98z"}),(0,A.Y)("path",{d:"M11 0C4.92 0 0 4.92 0 11a10.994 10.994 0 0014.03 10.57A6.5 6.5 0 0120 12.5c.65 0 1.27.09 1.86.27.09-.58.14-1.17.14-1.77 0-6.08-4.92-11-11-11zm2 11.43l-5.83 2.91-1.34-2.68L10 9.57V3h3v8.43z"})]})}const E=i.forwardRef(k);function T(e,t){return(0,A.FD)(O.A,{viewBox:"0 0 24 24",ref:t,...e,children:[(0,A.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.399 22.998A7.5 7.5 0 0123 10.865V7h-4V1H5v6H1v10c0 3.3 2.7 6 6 6h7.4l-.001-.002zM8 4v3h8V4H8z"}),(0,A.Y)("path",{d:"M21 13v6h-3v-6h3zM19.5 24a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"})]})}const B=i.forwardRef(T);var P=r(10846),U=r(89864),L=r(9628),$=r(4442),R=r(16924),x=r(64591),F=r(17649),N=r(89831),z=r(65416),W=r(82096),H=r(54246),G=r(96889),V=r(44580),K=r(2693),Q=r(45646),j=r(21635),q=r(2814),X=r(20692),Z=r(68926);const J=(0,o.I4)("div",(e=>{let{$theme:t,$isMobile:r,$hasSafeAreaBottomSpacing:i}=e;return{background:t.colors.backgroundPrimary,padding:i?`${t.sizing.scale600} ${t.sizing.scale600} ${t.sizing.scale900} ${t.sizing.scale600}`:r?t.sizing.scale600:t.sizing.scale800}})),ee=(0,o.I4)("div",{display:"flex",flexDirection:"row"}),te=(0,o.I4)("span",(e=>{let{$theme:t}=e;return{...t.typography.LabelMedium,marginBottom:"4px"}})),re=(0,o.I4)("p",(e=>{let{$theme:t}=e;return{...t.typography.ParagraphSmall,color:t.colors.contentSecondary}})),ie=(0,o.I4)("div",{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),oe={$width:"20px"},ne=(0,o._F)(S.A,(()=>({marginTop:"8px"}))),ae=e=>{let{children:t,isMobile:r,store:i}=e;const o=(0,h.zy)(),n=r?"/cart":void 0,a=(0,W.U)(o,{storeUuid:i.uuid,entryPoint:"multicart"},n);return(0,A.Y)(w.A,{$as:I.N_,to:a,children:t})},de=e=>{let{icon:t,title:r,message:i,primaryButton:o,secondaryButton:n}=e;const a=(0,h.zy)(),d=(0,_.lGi)(a),{closeSidebarCart:l}=(0,U.lK)(),s=(0,R.A)();return(0,A.FD)(A.FK,{children:[(0,A.FD)(ee,{children:[(0,A.Y)(K.IW,{$width:"2px"}),(0,A.Y)(ie,{children:t}),(0,A.Y)(K.IW,{...oe}),(0,A.FD)("div",{children:[(0,A.Y)(te,{children:r}),(0,A.Y)(re,{children:i})]})]}),(0,A.Y)(V.Ay,{$height:16}),o||(0,A.Y)(w.A,{$as:I.N_,to:d,onClick:l,children:(0,A.Y)(b.H,{id:"shared.findAnotherStore"})}),n||(o&&!s?(0,A.Y)(ne,{$as:I.N_,to:d,onClick:l,children:(0,A.Y)(b.H,{id:"shared.findAnotherStore"})}):null)]})},le=e=>{let{isMobile:t,store:r,validationError:i}=e;const o=(0,N.wA)(),{diningMode:n}=(0,F.A)(),a=(r.supportedDiningModes||[]).find((e=>{let{mode:t}=e;return"PICKUP"===t})),d="PICKUP"!==n&&Boolean(a?.isAvailable)?(0,A.Y)(w.A,{onClick:()=>{o((0,Q.RX)(r.uuid,{storeDiningMode:"PICKUP"}))},children:(0,A.Y)(b.H,{id:"components.checkout.switch_to_pickup"})}):null;return(0,A.Y)(de,{icon:(0,A.Y)(B,{size:23}),title:i.alert?.title?.text||"",message:i.alert?.body?.text||"",primaryButton:d})},se=e=>{let{isMobile:t,store:r}=e;const i=(0,P.I9)(),{deliveryAddress:o,diningMode:n}=(0,F.A)(),a=(0,L.jV)(),d=(0,$.Ay)(),l=Boolean(a?.determinedFromBackend)&&a?.isSchedulable,s=l?(0,A.Y)(ae,{store:r,isMobile:t,children:(0,A.Y)(b.H,{id:"shared.reschedule"})}):null,c=r.isOpen?(0,A.Y)(ne,{onClick:()=>{i.updateDraftOrder({overrides:{deliveryTime:{asap:!0},deliveryLocation:o,diningMode:n}})},children:(0,A.Y)(b.H,{id:"shared.deliverNow"})}):null;return(0,A.Y)(de,{icon:(0,A.Y)(E,{size:23}),title:a?.bottomSheetTitleMessage&&l?a.bottomSheetTitleMessage:(0,A.Y)(b.H,{id:"multicart.validation_not_accepting_orders"}),message:a?.bottomSheetSubtitleMessage&&l?a.bottomSheetSubtitleMessage:(0,A.Y)(b.H,{id:"multicart.validation_generic_unavailable_store"}),primaryButton:s,secondaryButton:d?.type===G.bT?void 0:c})},ce=e=>{let{isMobile:t,store:r}=e;const i=(0,L.jV)(),o=Boolean(i?.determinedFromBackend)&&i?.isSchedulable,n=o?(0,A.Y)(ae,{store:r,isMobile:t,children:(0,A.Y)(b.H,{id:"shared.scheduleOrder"})}):null;return(0,A.Y)(de,{icon:(0,A.Y)(M,{size:23}),title:i?.bottomSheetTitleMessage&&o?i.bottomSheetTitleMessage:(0,A.Y)(b.H,{id:"multicart.validation_not_accepting_orders"}),message:i?.bottomSheetSubtitleMessage&&o?i.bottomSheetSubtitleMessage:(0,A.Y)(b.H,{id:"multicart.validation_generic_unavailable_store"}),primaryButton:n})},ue=e=>{const t=(0,N.wA)(),r=(0,X.W6)(),o=(0,h.zy)(),n=(0,z.d4)((e=>{let{user:t}=e;return t.data?.isLoggedIn??!1})),a=(0,$.Ay)(),{isDraftOrderParticipant:d}=(0,F.A)(),l=(0,s.Yh)(),{cartItems:c,upsellFeed:u}=(0,s.Ay)(["cartItems","upsellFeed"]).checkoutPayloads,m=(0,j.A)(),f=(0,p.Ay)(),y=a?.type===G.it,g=m&&c&&(0,H.n)(c),v=Boolean(a?.alert?.richBody),Y=!d&&(l.isLoading||y&&!g),b=(0,x.A)(),{canShow:I}=(0,q.A)(e.store.uuid),S=(0,Z.A)();if(i.useEffect((()=>{S&&n&&t({type:"UPSELL_FEED_SUCCESS",payload:u})}),[u,t,S,n]),!d&&Boolean(a?.type)&&!v){if(f("eats:multicart_error",{error:a}),a?.type===G.Pc)return(0,A.Y)(J,{$isMobile:e.isMobile,$hasSafeAreaBottomSpacing:b,children:(0,A.Y)(ce,{...e})});if(a?.type===G.Rf)return(0,A.Y)(J,{$isMobile:e.isMobile,$hasSafeAreaBottomSpacing:b,children:(0,A.Y)(le,{...e,validationError:a})});if(a?.type===G.bT)return(0,A.Y)(J,{$isMobile:e.isMobile,$hasSafeAreaBottomSpacing:b,children:(0,A.Y)(se,{...e})})}return(0,A.Y)(J,{$isMobile:e.isMobile,$hasSafeAreaBottomSpacing:b,children:(0,A.Y)(C.A,{$disabled:Y,onNavigateToCheckout:e=>{S&&I&&(e.preventDefault(),r.push((0,_.tVE)(o)))}})})};var he=r(63887),pe=r(16144),me=r(66039),fe=r(66371),_e=r(85951),ye=r(83604),ge=r(92208),Ae=r(65926),ve=r(73569),Ye=r(85906),be=r(85913),Ie=r("__fusion__95b4ba69e5"),Ce=r(21499),Se=r(54038),we=r(74225),Oe=r(35152);var De=r(23977);const Me="LIVE_ORDER_LATE_EDIT_WARNING",ke=()=>{const{liveOrderUuid:e}=(0,De.G)(),t=(0,Ye.u)({getCartFrom:"workflowId",workflowId:e}),r=(e=>{const t=(0,we.useQueryClient)(),r=(0,h.W6)(),i=(0,Oe._l)((t=>(0,_.Ysx)(t,{uuid:e}).pathname)),{hideSidebarCart:o}=(0,U.lK)();return Ie.useCallback((async()=>{await t.invalidateQueries(["getActiveOrdersV1"]),o(),r.replace(i)}),[t,o,r,i])})(e),i=(0,p.Ay)(),[o,n]=Ie.useState(null),a=(0,Se.A)(),[d,l]=Ie.useState(null),s=Ie.useCallback((async o=>{switch(t.status){case"AVAILABLE":case"SYNCING":t.actions?.confirmCartUpdates({type:o}).then((()=>{"CONFIRM"===o&&i("eats:loe_update_order_succeeded",{workflowUuid:e}),r()})).catch((o=>{const d=(0,Ce.bu)(Me);let l=!0;"UPDATE_ORDER_BOTTOM_SHEET"===o?.name?("LIVE_ORDER_LATE_EDIT_WARNING"===o?.payload?.[0]?.type?(l=!d?.[e],l&&(0,Ce.Vv)(Me,{...d,[e]:!0},3600),i("eats:loe_update_order_succeeded",{workflowUuid:e})):i("eats:loe_unable_update_order",{workflowUuid:e}),l&&o?.payload?.[0]&&n(o.payload[0]),t.actions.syncCart({workflowUUID:e,orderUUID:e}),"LIVE_ORDER_LATE_EDIT_WARNING"===o?.payload?.[0]?.type&&d?.[e]&&r()):a()}))}}),[t,i,r,a,e]),c=Ie.useCallback((e=>{e&&l(e)}),[]);return Ie.useEffect((()=>{d&&(l(null),s(d))}),[d,s]),{liveOrderUuid:e,liveOrderQuantityError:o,handleUpdateLiveOrder:c,setLiveOrderQuantityError:n,hideCartAndRedirect:r}},Ee=(0,o.I4)("div",(e=>{let{$theme:t}=e;return{background:t.colors.backgroundPrimary,padding:t.sizing.scale600,display:"flex",flexDirection:"column",gap:t.sizing.scale400}})),Te=()=>{const{liveOrderUuid:e,liveOrderQuantityError:t,handleUpdateLiveOrder:r,setLiveOrderQuantityError:i,hideCartAndRedirect:o}=ke(),n=(0,ye.S)({cartType:"LIVE_ORDER",getCartFrom:"workflowId",workflowId:e,selector:e=>e.rawCartData?.liveOrder?.cart?.shoppingCart}),a=(0,Ye.u)({getCartFrom:"workflowId",workflowId:e}),d=(0,ge.Oz)(n),l="SYNCING"===a.status,s=(0,p.Ay)(),c=t=>{s("CONFIRM"===t?"eats:loe_update_order_tapped":"eats:loe_discard_updates",{workflowUuid:e}),r(t)};return(0,A.FD)(A.FK,{children:[t?(0,A.Y)(be.A,{orderValidationError:t,onClose:()=>{"LIVE_ORDER_LATE_EDIT_WARNING"===t?.type&&o(),i(null)}}):null,d?(0,A.FD)(Ee,{children:[(0,A.Y)(Ae.A,{overrides:{BaseButton:{style:()=>({width:"100%"})}},size:ve.SK.large,onClick:()=>c("CONFIRM"),disabled:l,children:(0,A.Y)(b.H,{id:"shared.updateOrder"})}),(0,A.Y)(Ae.A,{overrides:{BaseButton:{style:()=>({width:"100%",":hover":{backgroundColor:"transparent"},":active":{backgroundColor:"transparent"}})}},kind:ve.Nd.tertiary,size:ve.SK.large,onClick:()=>c("DISCARD"),disabled:l,children:(0,A.Y)(b.H,{id:"edit_order.discard_button"})})]}):null]})};var Be=r(34231),Pe=r(34262),Ue=r(25816),Le=r(5595),$e=r(69213);const Re=(0,o.I4)("div",{position:"sticky",bottom:0,margin:"0 !important"}),xe=(0,o.I4)("div",(e=>{let{$theme:t}=e;return{padding:"0px 16px"}})),Fe=(0,o.I4)("div",(e=>{let{$theme:t}=e;return{borderTop:`1px solid ${t.colors.borderOpaque}`}})),Ne=(0,o.I4)("div",(e=>{let{$theme:t}=e;return{backgroundColor:t.colors.backgroundPrimary}})),ze=(0,o.I4)("div",{flexGrow:1}),We=e=>{let{hasGroupOrder:t,isMobile:r,store:l,quantitySelectType:c,isLiveOrder:u}=e;const{stopTiming:h}=(0,fe.zR)(),{addOnOffer:p}=(0,Pe.c)(),[m,f]=(0,o.c6)(),_=(0,d.A)("cart_checkout_auto_renew_nudge_enabled");(0,i.useEffect)((()=>{h(_e.s.CART_SELECTED_FROM_POPOVER,{shouldEmitTiming:!0})}),[h]);const y=(0,Ue.A)((0,s.q5)("merchantMembership")),g=(0,$e.A)()&&y&&l.uuid;return(0,A.FD)(A.FK,{children:[t?(0,A.FD)("div",{children:[(0,A.Y)(n.ro,{$spaceAfter:16}),(0,A.Y)(he.A,{gutterWidth:16}),(0,A.Y)(me.A,{gutterWidth:16,showAddGuestsBtn:!1,showFacePile:!0,showRemoveParticipantButton:!0})]}):(0,A.Y)(pe.Ay,{quantitySelectType:c}),(0,A.Y)(ze,{}),u?(0,A.Y)(Re,{children:(0,A.Y)(Te,{})}):(0,A.FD)(Re,{children:[p&&r?(0,A.Y)(Be.u,{styleOverrides:{bottom:f.sizing.scale600,position:"relative"},storeUUID:l.uuid,shouldRedirectToHomeAfterClearCart:!0}):null,g?(0,A.FD)(xe,{children:[(0,A.Y)(Fe,{}),(0,A.Y)(Ne,{children:(0,A.Y)(Le.A,{merchantMembership:y,storeUuid:l.uuid})})]}):null,_?(0,A.Y)(Y,{}):null,(0,A.Y)(a.E,{}),(0,A.Y)(ue,{isMobile:r,store:l})]})]})}},75880:(e,t,r)=>{r.d(t,{A:()=>s});var i=r(90417),o=r(91156),n=r(32879),a=r(71715),d=r(66371),l=r(85951);const s=e=>{let{cartOpen:t,store:r,draftOrder:s}=e;const c=(0,o.Ay)(),{stopTiming:u}=(0,d.zR)(),h=(0,i.useRef)({startTime:0,storeTime:0,draftOrderTime:0,checkoutPresentationTime:0}),{activeDraftOrderUUID:p}=(0,a.A)(),m=(0,n.Yh)();(0,i.useEffect)((()=>{t&&p&&(h.current.startTime=Date.now())}),[t,p]),(0,i.useEffect)((()=>{if(!h.current.startTime)return;const e=Boolean(r?.hasLoaded&&s?.hasLoaded&&m?.hasLoaded),t=Boolean(r?.data&&s?.data&&m?.data),i=Date.now()-h.current.startTime,o=(e,t)=>t&&!h[e]&&(h[e]=i);o("storeTime",r?.hasLoaded),o("draftOrderTime",s?.hasLoaded),o("checkoutPresentationTime",m?.hasLoaded);e&&h.current.startTime&&((()=>{const e={shouldEmitTiming:!0};u(l.s.PDP_ADD_TO_CART,e),u(l.s.QUICK_VIEW_ADD_TO_CART,e),u(l.s.CART_LOAD_FROM_HEADER_CLICK,e)})(),h.current.startTime=0,t&&c("eats:cart_latency",{timing:String(i)}))}),[t,r?.hasLoaded,s?.hasLoaded,m?.hasLoaded])}},93736:(e,t,r)=>{r.d(t,{A:()=>ae});var i=r("__fusion__95b4ba69e5"),o=r(66764),n=r(57716),a=r(50371),d=r(12424),l=r(91156),s=r(76022),c=r(28167),u=r(41967),h=r(4914),p=r(73792);function m(e){const t=(0,p.W)(),r=e.diningMode||t;if(!r)return e.delivery;switch(r){case"PICKUP":return e.pickup;case"DINE_IN":return e.dineIn;case"ON_PREMISE_DELIVERY":return e.onPremiseDelivery?e.onPremiseDelivery:e.delivery;default:return e.delivery}}var f=r(8700),_=r(41908),y=r(87731),g=r(56489),A=r(17649),v=r(46829),Y=r(40014);const b=(0,u.I4)("div",(e=>{let{$theme:t}=e;return{...t.typography.ParagraphMedium,color:t.colors.contentSecondary}})),I=()=>{const e=(0,h.c)(),{serverCart:t}=(0,_.B_)(),{store:r}=(0,f.Ay)(t.data?.storeUuid),i=(0,y.A)(),{deliveryAddress:o,deliveryTime:n,diningMode:a=v.nQ.DELIVERY}=(0,A.A)();if(!n||!o||!a)return null;const{date:d,endTime:l}="date"in n&&n||{},s={userAddress:o?.address.address1,storeAddress:r.data?.location.streetAddress,...d&&void 0!==l&&{time:(0,g.Ku)(i,l),date:(0,g.Y)(i,d)}},[c,u,p]=d?(0,g.c_)(d)?[e("multicart.deliver_scheduled_today",s),e("multicart.dine_in_scheduled_today",s),e("multicart.pickup_scheduled_today",s)]:(0,g.w0)(d)?[e("multicart.deliver_scheduled_tomorrow",s),e("multicart.dine_in_scheduled_tomorrow",s),e("multicart.pickup_scheduled_tomorrow",s)]:[e("multicart.deliver_scheduled",s),e("multicart.dine_in_scheduled",s),e("multicart.pickup_scheduled",s)]:[e("multicart.deliverNow",s),e("multicart.dineInNow",s),e("multicart.pickupNow",s)];return(0,Y.Y)(b,{children:(0,Y.Y)(m,{diningMode:a,delivery:c,dineIn:u,pickup:p})})};var C=r(29077),S=r(58030),w=r(2111),O=r(36106),D=r(31725),M=r(62588),k=r(86105),E=r(535),T=r(72632),B=r(89864),P=r(65372);const U=(0,u.I4)(n.N_,(e=>{let{$theme:t}=e;return{...t.typography.LabelMedium}})),L=(0,u.I4)("span",(e=>{let{$theme:t}=e;return{...t.typography.LabelMedium,color:t.colors.action}}));const $=function(e){let{mealPlanUUID:t,isGroupOrderOwner:r}=e;const i=(0,k.zy)(),{mealPlan:o}=(0,E.A)(t),n=(0,h.c)(),{closeSidebarCart:a}=(0,B.lK)(),d=(0,l.Ay)();if(null==o)return null;const s=(0,M.n)(n("shared.orderInfo.part_of"),{displayText:(0,Y.Y)(L,{children:o?.name})});return(0,Y.Y)(U,{to:(0,T.p3)(i,t),onClick:()=>{d("eats:meal_plan_view_button",{mealPlanUUID:t,role:(0,P.Lw)(r,!0),source:"cart-subtitle"}),a()},children:s})};var R=r(78275),x=r(65926),F=r(73569),N=r(72730),z=r(66433),W=r("__fusion__927de805d6"),H=r("__fusion__934bf744b7"),G=r(16439),V=r(84183),K=r(8474),Q=r(79580),j=r(96970),q=r(5230),X=r(36291);const Z=(0,u.I4)("div",(e=>{let{$theme:t}=e;return{display:"flex",alignItems:"center",gap:t.sizing.scale600}})),J=(0,u.I4)("div",(e=>{let{$theme:t}=e;return{flex:1,gap:t.sizing.scale100}})),ee=(0,u.I4)("div",(e=>{let{$theme:t}=e;return{...t.typography.HeadingLarge,padding:0,overflowWrap:"anywhere"}})),te=(0,u.I4)(n.N_,(e=>{let{$theme:t,$isCartDrafting:r}=e;return{...r?{...t.typography.DisplayBold4XSmall}:{...t.typography.HeadingLarge},":hover":{borderBottom:`1px solid ${t.colors.blackHover}`}}})),re=(0,u.I4)(n.N_,(e=>{let{$theme:t}=e;return{...t.typography.LabelMedium}})),ie=()=>{const{restaurantLink:e,restaurantLinkNode:t,onGoToStore:r}=(0,s.A)();return(0,Y.Y)(re,{to:e,onClick:r,children:t})},oe=e=>{const{isMobile:t}=(0,z.k)(),{isBundledOrder:r,isGroupOrder:i}=(0,_.tC)(),{storeTitle:n,restaurantLink:a,title:d,onGoToStore:l}=(0,s.A)(),c=i||e.shouldShowSmartCartTitle;return r?(0,Y.Y)(ee,{children:(0,Y.Y)(o.H,{id:"cart.title.bundled_order"})}):!e.isCartDrafting||c||t?c?(0,Y.Y)(ee,{children:d}):(0,Y.Y)(te,{$isCartDrafting:e.isCartDrafting,to:a,onClick:l,children:n}):(0,Y.Y)(N.d8,{labelSize:"large"})},ne=e=>{const t=(0,a.W6)(),r=(0,k.zy)(),{user:i}=(0,V.A)(),{isMobile:o}=(0,z.k)(),{isCartDrafting:n}=(0,R.A)(),d=(0,G.A)(),{isBundledOrder:l,isGroupOrder:s}=(0,_.tC)(),{allowGroupOrder:c}=(0,Q.K)({store:e.store}),u=(0,h.c)();return o&&c?(0,Y.Y)("div",{children:n&&d&&!l?s&&i.data?.isLoggedIn?(0,Y.Y)(x.A,{"data-testid":"share-group-order",kind:F.Nd.tertiary,onClick:()=>t.push((0,K.Zyy)(r,"shareGroupOrder")),children:(0,Y.Y)(H.default,{size:20})}):(0,Y.Y)(x.A,{"data-testid":"start-group-order","aria-label":u("groupOrder.addPeopleGroupOrder"),kind:F.Nd.tertiary,onClick:()=>t.push((0,K.xCk)(r,(0,K.oLA)(e.store))),children:(0,Y.Y)(W.default,{size:20})}):null}):null},ae=e=>{let{store:t,onCartClose:r=d.A,onClearCart:o,cartActionsType:n}=e;const{isCartDrafting:a}=(0,R.A)(),s=(0,l.Ay)(),u=(0,X.A)(),h=(0,c.A)(),p=(0,_.tC)(),{isGroupOrder:m,isBundledOrder:f,mealPlanUUID:y,isGroupOrderOwner:g}=p,[A,v]=i.useState(!1),b=()=>v(!1),M=(0,w.DW)(),{isMobile:k}=(0,z.k)();i.useEffect(h,[]);const E=(0,D.A)("canonical_product_smart_cart"),T=(0,D.A)("orchid_analytics_event_bridge_enabled"),{currentCartIsSmartCart:B}=(0,O.T)(),P=B&&E,U=i.useRef(!0),L="bottomsheet"===n,x=(0,q.A)();return i.useEffect((()=>{U.current&&(s("eats:cart_view",{draftOrderUuid:p.draftOrderUUID,isMulticart:"true",storeUuid:p.storeUUID??"",isGroupOrder:String(p.isGroupOrder),isDraftOrderParticipant:String(p.isGroupOrderParticipant),isBillSplitOrder:String(p.isBillSplitOrder),cartView:M,isBundledOrder:p.isBundledOrder,isAddOnOrder:p.isAddOnOrder,deliveryType:p.draftOrder?.deliveryType,isScheduledOrder:p.isScheduledOrder,...p.isBundledOrder&&{storePreCheckoutBundling:{sourceType:"BUNDLED_STORE"}},isDrafting:a}),x&&T&&u({type:"VIEW_CART"})),U.current=!1}),[s,p,M,a,x,T,u]),(0,Y.FD)(Z,{"data-test":"cart-header",children:[(0,Y.FD)(J,{children:[(0,Y.Y)(oe,{isCartDrafting:a,shouldShowSmartCartTitle:P}),m&&(0,Y.FD)(Y.FK,{children:[y?(0,Y.Y)($,{mealPlanUUID:y,isGroupOrderOwner:g}):(0,Y.Y)(ie,{}),(0,Y.Y)(C.A,{})]}),a&&m&&!f||a&&!m&&!f&&k?(0,Y.Y)(I,{}):null]}),(0,Y.Y)(ne,{store:t}),!a||k?(0,Y.Y)(j.A,{store:t,onClearCart:o,onCartClose:r,onCloseCartActions:b,bottomSheet:L,openCartActions:()=>v(!0)}):null,L?(0,Y.Y)(S._,{store:t,onCartClose:r,onClearCart:o,onCloseList:b,cartActionsOpen:A}):null]})}},__fusion__934bf744b7:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var i=r(90417),o=r(40014);const n=i.forwardRef((function(e,t){let{title:r="Person add",titleId:i,size:n="1em",...a}=e;return(0,o.FD)("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",ref:t,"aria-labelledby":i,...a,children:[void 0===r?(0,o.Y)("title",{id:i,children:"Person add"}):r?(0,o.Y)("title",{id:i,children:r}):null,(0,o.Y)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11Zm13 5h-3v-3h-3v3h-3v3h3v3h3v-3h3v-3ZM1 23h12.1c-1-1.2-1.6-2.8-1.6-4.5 0-1.7.6-3.3 1.6-4.5H7c-3.3 0-6 2.7-6 6v3Z",fill:"currentColor"})]})}))}}]);
//# sourceMappingURL=https://sourcemaps.uberinternal.com/raw/web-eats-v2/client-6119-150b39712c0c7c9d.js.map