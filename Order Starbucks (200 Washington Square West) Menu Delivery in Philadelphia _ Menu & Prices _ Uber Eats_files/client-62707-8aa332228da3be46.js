"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[62707,90021],{34789:(t,e,r)=>{r.d(e,{A:()=>n});var a=r(93720);const n={accessibilityType:a.IP.tooltip,focusLock:!1,autoFocus:!1,returnFocus:!1,onMouseEnterDelay:200,onMouseLeaveDelay:200,overrides:{},placement:a.El.auto,popoverMargin:0,showArrow:!1,triggerType:a.IJ.hover,renderAll:!1}},44784:(t,e,r)=>{r.d(e,{_:()=>d});var a=r(90417),n=r(23933),i=r(97887),s=r(8700);var o=r(83604),c=r(57577);const d=t=>{const e=(0,n.B_)(),{queue:r}=(0,c.x)({...t,cartType:"DRAFT_ORDER"}),d=(0,o.S)({...t,cartType:"DRAFT_ORDER",selector:t=>t.status}),l=(0,o.S)({...t,cartType:"DRAFT_ORDER",selector:t=>t.rawCartData?.draftOrder?.restaurantUUID}),{store:u}=(0,s.Ay)(l),_=(0,a.useRef)(null);_.current=u;const p=(0,i.g)(),h=(0,a.useRef)(null);h.current=p;const T=(0,a.useCallback)((t=>((t=>!(!t||"object"!=typeof t)&&"name"in t)(t)&&(t=>["ADD_ITEM_UNKNOWN","DELETE_ITEM_UNKNOWN","UPDATE_ITEM_UNKNOWN","UNKNOWN"].includes(t.name))(t)&&_.current&&h.current?.(!1,t.error,!1,_.current),Promise.reject(t))),[h,_]),D=(0,a.useCallback)((async t=>r.pushInteraction({type:"CREATE_CART",payload:t}).catch(T)),[r,T]),I=(0,a.useCallback)((async t=>r.pushInteraction({type:"EDIT_ITEM_QUANTITY",payload:t}).catch(T)),[r,T]),A=(0,a.useCallback)((async()=>r.pushInteraction({type:"DELETE_CART",payload:{}}).catch(T)),[r,T]);return(0,a.useMemo)((()=>{if("FETCHING"===e.state)return{status:"LOADING"};switch(d){case"OUTDATED":case"UPDATING":return{status:"OUTDATED"};case"INACTIVE":default:return{status:"LOADING"};case"DELETING_CART":return{status:"DELETING",actions:{editQuantityInCart:D}};case"MISSING_CART":return{status:"MISSING",actions:{editQuantityInCart:D}};case"CREATING_CART":return{status:"CREATING",actions:{editQuantityInCart:I}};case"IN_SYNC":case"OUT_OF_SYNC":case"SYNCING":return{status:"SYNCING"===d?"SYNCING":"AVAILABLE",actions:{editQuantityInCart:I,deleteCart:A}}}}),[e.state,d,D,I,A])}},54960:(t,e,r)=>{r.d(e,{A:()=>l});var a=r(90417),n=r(29054),i=r(49728),s=r(34789),o=r(75249),c=r(40014);class d extends a.Component{static defaultProps={...s.A};render(){const t=(0,i.Qp)({Arrow:o.i3,Body:o.nB,Inner:o.Rp},this.props.overrides);return(0,c.Y)(n.A,{autoFocus:!1,"data-baseweb":"tooltip",...this.props,overrides:t})}}const l=d},62707:(t,e,r)=>{r.d(e,{z6:()=>j,Ay:()=>q,ur:()=>K});var a=r(90417),n=r("__fusion__95b4ba69e5"),i=r(50371),s=r(66764),o=r(4914),c=r("__fusion__e1fb3c6937"),d=r(54960),l=r(93720),u=r(39027),_=r(25263),p=r(41967),h=r(71715),T=r(91156),D=r(17649),I=r(71085),A=r(74141),C=r(65714),E=r(73569),f=r(86105),O=r(41908),y=r(80672),m=r(44784),R=r(35508),g=r(8474),b=r(66371),v=r(85951),N=r(81464),w=r(18789),U=r(39182),S=r(65416),Y=r(23933),L=r(83604);var B=r(61079),F=r(23977),M=r(33293),k=r(89831),G=r(10846),P=r(76388),z=r(97684),x=r(40014);const H=(0,p.I4)(C.$n,(t=>{let{$theme:e}=t;return{width:"100%",boxShadow:e.lighting.deepBelow,transition:`background-color ${U.bm.defaultDuration}`,":disabled":{backgroundColor:e.colors.contentTertiary,color:e.colors.contentInversePrimary}}})),Q=(0,p.I4)("div",(t=>{let{$theme:e,$shouldCapitalize:r}=t;return{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",color:e.colors.buttonPrimaryText,...r?{textTransform:"capitalize"}:{}}})),W=(0,p.I4)("span",(t=>{let{$theme:e}=t;return{marginLeft:e.sizing.scale300}})),V=(0,p.I4)("div",(t=>{let{$theme:e}=t;return{display:"flex",color:e.colors.primaryB,flexDirection:"row",alignItems:"center"}})),K=()=>{const{draftOrder:t,isBundledOrder:e,bundledOrders:r}=(0,O.tC)();return(0,a.useMemo)((()=>{if(!e)return 0;const a=(0,y.IF)(t?.shoppingCart?.items);return(r||[]).reduce(((t,e)=>t+(0,y.IF)(e?.shoppingCart?.items)),a)}),[t,e,r])},$=()=>{const t=K();return(0,x.FD)(x.FK,{children:[(0,x.Y)(c.default,{size:24}),(0,x.Y)(W,{children:(0,x.Y)(s.H,{id:"store.bundle_store.view_cart_text",data:{totalItems:t}})})]})},j=t=>{let{onViewCartButtonVisibilityChange:e,storeUuid:r,Wrapper:n}=t;const d=(0,f.zy)(),l=(0,i.W6)(),u=(0,f.g)(),_=(0,o.c)(),p=(0,I.A)({encodedStoreUuid:u?.encodedStoreUuid||r}),D={getCartFrom:"storeId",storeId:p},A=(0,m._)(D),C=(0,L.S)({...D,cartType:"DRAFT_ORDER",selector:t=>t.rawCartData?.cartQuantities}),{isLiveOrder:O}=(0,F.G)(),y=(0,B.P)(),U=(0,L.S)({...D,cartType:"DRAFT_ORDER",selector:t=>t.rawCartData?.draftOrder?.uuid??""}),S=(t=>{const e=(0,Y.B_)(),r=(0,L.S)({...t,cartType:"DRAFT_ORDER",selector:t=>t.rawCartData?.preCheckoutBundling?.otherOrdersInBundle}),n=(0,a.useMemo)((()=>r?.map((t=>{const r=e.getQueueFromCache({type:"storeId",storeId:t.storeId});return{role:t.role,rawCartData:r.getSnapshot().rawCartData}})).filter((t=>t.rawCartData))??[]),[e,r]);return(0,a.useMemo)((()=>n.length>0?{type:"BUNDLED",otherOrders:n}:{type:"DEFAULT"}),[n])})(D),z=(0,T.Ay)(),{startTiming:V}=(0,b.zR)(),K=(0,w.A)(),$="CREATING"===A.status&&K,{setActiveDraftOrder:j}=(0,h.A)(),{isAddOnStore:q,addOnOfferContext:Z}=(0,M.A)(p||""),J=(0,k.wA)(),{updateDraftOrder:X}=(0,G.I9)();let tt=R.R9.from(0),et=!1;switch(A.status){case"CREATING":case"OUTDATED":case"AVAILABLE":case"SYNCING":("CREATING"!==A.status||$)&&(Object.entries(C??{}).reduce(((t,e)=>{let[r,a]=e;return t.add(a.currentQuantity)}),tt),"BUNDLED"===S.type&&(et=!0,S.otherOrders.forEach((t=>{Object.entries(t.rawCartData?.cartQuantities??{}).reduce(((t,e)=>{let[r,a]=e;return t.add(a.currentQuantity)}),tt)}))))}O&&y&&(tt=R.R9.from(y));const rt=(0,a.useCallback)((()=>{q&&(J((0,P.eW)("MULTI_RESTAURANT_ORDERING_ADD_ON")),X({append:{addOnOfferContext:Z}})),V(v.s.CART_LOAD_COMPLETE,{shouldOverride:!0,metadata:{entryPoint:"view_cart_button"}}),V(v.s.CART_LOAD_COMPLETE_WITH_ITEMS,{shouldOverride:!0,metadata:{entryPoint:"view_cart_button"}}),z("eats:cart_cta_click",{isMulticart:"true",...et?{storePreCheckoutBundling:{sourceType:"BUNDLED_STORE"}}:null}),j(U),l.push((0,g._Bq)(d,{draftOrderId:U}),{clearLocation:d})}),[V,z,et,j,U,l,d,Z,J,q,X]);(0,N.A)({eventName:"eats:multicart_cart_pill",eventPayload:{...et?{storePreCheckoutBundling:{sourceType:"BUNDLED_STORE"}}:null},shouldEmit:tt.isGt(0)});const at=tt.isGt(0);return(0,a.useEffect)((()=>{e?.(at)}),[at,e]),at?(0,x.Y)(n,{children:(0,x.Y)(H,{"aria-label":_($?"shared.creating_cart":"shared.viewCart"),size:E.SK.large,onClick:rt,disabled:$,"data-testid":"view-cart-button",children:(0,x.Y)(Q,{children:$?(0,x.Y)(s.H,{id:"components.cart_button.creating_cart_text"}):et?(0,x.FD)(x.FK,{children:[(0,x.Y)(c.default,{size:24}),(0,x.Y)(W,{children:(0,x.Y)(s.H,{id:"store.bundle_store.view_cart_text",data:{totalItems:Math.ceil(tt.toFloat())}})})]}):(0,x.Y)(s.H,{id:"components.cart_button.multicart_view_cart_text",data:{totalItems:Math.ceil(tt.toFloat())}})})})}):null},q=t=>{let{linkUrl:e,Wrapper:r}=t;const[a,c]=n.useState(!1),[,h]=(0,p.c6)(),C=n.useRef(!0),y=n.useRef(null),m=(0,f.zy)(),R=(0,i.W6)(),g=(0,f.g)(),N=(0,o.c)(),w=(0,T.Ay)(),{isSecondaryBundledStore:U,primaryBundledStoreUuid:Y}=(0,A.A)(),L=(0,I.A)({encodedStoreUuid:g?.encodedStoreUuid}),{hasGroupOrder:B,isBillSplitOrder:F,currentUserItemCount:M,isDraftOrderCreator:k,draftOrder:G,draftOrderUuid:P}=(0,D.A)(L),W=(0,S.d4)((t=>{let{draftOrder:e,quickAdd:r}=t;return(e.draftOrder.isLoading||e.draftOrder.data?.draftOrder.storeUuid!==L)&&r.storeUUID===L&&(0,z.X)(r.quantities).length>0&&M<1})),K=(0,D.A)(Y),{startTiming:j}=(0,b.zR)(),q=M&&B&&F&&!k&&C.current,Z=U&&G||"PRIMARY"===G?.bundleGroupInfo?.bundleGroupRole;return n.useEffect((()=>()=>{clearTimeout(y.current)}),[]),n.useEffect((()=>{w("eats:multicart_cart_pill",{...Z?{storePreCheckoutBundling:{sourceType:"BUNDLED_STORE"}}:null})}),[w,Z]),n.useEffect((()=>{C.current=!0}),[M]),n.useEffect((()=>{q&&(c(!0),C.current=!1,y.current=setTimeout((()=>{c(!1)}),5e3))}),[q]),M<1&&!W?null:(0,x.FD)(r,{children:[(0,x.Y)(d.A,{isOpen:a,placement:l.El.top,showArrow:!0,overrides:{Inner:{style:t=>{let{$theme:e}=t;return{paddingLeft:e.sizing.scale600,paddingRight:e.sizing.scale600,paddingTop:e.sizing.scale600,paddingBottom:e.sizing.scale600,display:"flex"}}}},content:()=>(0,x.FD)(V,{children:[(0,x.Y)(u.ED,{width:h.sizing.scale4800,marginRight:h.sizing.scale500,color:h.colors.primaryB,children:(0,x.Y)(s.H,{id:"go.bill.split.add.item.tooltip.text"})}),(0,x.Y)(_.A,{onClick:()=>c(!1),size:16})]}),children:(0,x.Y)("div",{})}),(0,x.Y)(H,{"aria-label":N(W?"shared.creating_cart":"shared.viewCart"),size:E.SK.large,onClick:()=>{j(v.s.CART_LOAD_COMPLETE,{shouldOverride:!0,metadata:{entryPoint:"view_cart_button"}}),j(v.s.CART_LOAD_COMPLETE_WITH_ITEMS,{shouldOverride:!0,metadata:{entryPoint:"view_cart_button"}}),w("eats:cart_cta_click",{isMulticart:"true",...Z?{storePreCheckoutBundling:{sourceType:"BUNDLED_STORE"}}:null}),R.push(e,{clearLocation:m})},disabled:W,"data-testid":"view-cart-button",children:(0,x.Y)(Q,{children:W?(0,x.Y)(s.H,{id:"components.cart_button.creating_cart_text"}):Z?(0,x.Y)(O.kd,{draftOrderUUID:U?K.draftOrderUuid:P,children:(0,x.Y)($,{})}):(0,x.Y)(s.H,{id:"components.cart_button.multicart_view_cart_text",data:{totalItems:M}})})})]})}},__fusion__e1fb3c6937:(t,e,r)=>{r.r(e),r.d(e,{default:()=>i});var a=r(90417),n=r(40014);const i=a.forwardRef((function(t,e){let{title:r="Delivery bag two",titleId:a,size:i="1em",...s}=t;return(0,n.FD)("svg",{width:i,height:i,viewBox:"0 0 24 24",fill:"none",ref:e,"aria-labelledby":a,...s,children:[void 0===r?(0,n.Y)("title",{id:a,children:"Delivery bag two"}):r?(0,n.Y)("title",{id:a,children:r}):null,(0,n.FD)("g",{fill:"currentColor",children:[(0,n.Y)("path",{d:"M21 7V2h-6v3h3v11c0 1.54-.59 2.94-1.54 4H20c2.21 0 4-1.79 4-4V7h-3Z"}),(0,n.Y)("path",{d:"M13 2H3v5H0v9c0 2.21 1.79 4 4 4h8c2.21 0 4-1.79 4-4V7h-3V2ZM6 7V5h4v2H6Z"})]})]})}))}}]);
//# sourceMappingURL=https://sourcemaps.uberinternal.com/raw/web-eats-v2/client-62707-8aa332228da3be46.js.map